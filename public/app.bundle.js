webpackJsonp([0],{0:function(t,exports,e){e(1),t.exports=e(298)},298:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var i=e(299),o=n(i),a=e(301),s=n(a),r=e(302),l=n(r),c=e(304),u=n(c),d=e(306),m=n(d),f=e(308),p=n(f),h=e(310),g=n(h),v=e(312),b=n(v),y=e(314),_=n(y),k=e(316),S=n(k),w=e(318),T=n(w),x=e(572),C=n(x),M=e(649),A=n(M);o.default.module("app",[s.default,l.default,u.default,m.default,p.default,g.default,b.default,_.default,S.default,T.default,C.default]).component("app",A.default).config(["$provide","$locationProvider","$stateProvider","$urlRouterProvider","$mdGestureProvider","$mdThemingProvider","cfpLoadingBarProvider",function(t,e,n,i,o,a,s){"ngInject";s.spinnerTemplate='<div id="loading-spinner" class="loading-spinner-container" layout layout-fill layout-align="center center">\n  \t<md-progress-circular md-mode="indeterminate" class="md-primary">\n  \t</md-progress-circular>\n  </div>',o.skipClickHijack(),a.definePalette("UOITprimary",{50:"0086FC",100:"45A1FA",200:"74B8FB",300:"A2D0FD",400:"0077CA",500:"006BB8",600:"005FA6",700:"005495",800:"004883",900:"003C71",A100:"ff8a80",A200:"ff5252",A400:"ff1744",A700:"d50000",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","A100"],contrastLightColors:null}),a.theme("default").primaryPalette("UOITprimary",{default:"400","hue-1":"300","hue-2":"500","hue-3":"900"}).accentPalette("grey"),e.html5Mode(!0),n.state("home",{template:"<ui-view></ui-view>"}),i.otherwise("/"),t.decorator("$exceptionHandler",["$log","$delegate","$injector",function(t,e,n){return function(t,i){var o=n.get("$rootScope");i||(i="Application error"),o.$broadcast("handler:exception",{exception:t,cause:i}),e(t,i)}}])}]).run(["$rootScope","$state","$compile","$mdUtil","$popupWindow","UserAuth","AUTH_EVENTS",function(t,e,n,i,a,s,r){"ngInject";t.$on("cfpLoadingBar:started",function(e){return i.nextTick(function(e){return n(o.default.element(document.getElementById("loading-spinner")))(t)})}),t.$on("handler:exception",function(t,e){var n={type:e.cause,message:e.exception.message,suggest:[0,2,1]};return a.warning({locals:n})}),t.$on("$stateChangeStart",function(e,n,i,o,a,l){n.data&&n.data.roles&&!s.isAuthorized(n.data.roles)&&(e.preventDefault(),s.isAuthenticated()?t.$broadcast(r.notAuthorized):t.$broadcast(r.notAuthenticated))}),t.$on("$stateChangeSuccess",function(e,n,i,o,a){t.pageTitle="UOIT Virtual Tour",n.label&&(t.pageTitle+=" | ",t.pageTitle+=n.label)}),t.$on("$stateChangeError",function(t,e,n,i,o,s){console.log("STATE CHANGE ERROR: ",s,e,n,i,o);var r={type:"Navigation issue!",message:s.message||s.msg||"The view you requested hit a snag while loading.",suggest:[4,3]};a.error({locals:r})}),t.$on("$stateNotFound",function(t,e,n,i){var o={type:"Page not found!",message:"The page associated with ("+e.to+" : "+e.toParams+") cannot be located.",suggest:[3]};a.error({locals:o}),console.log("STATE NOT FOUND",e,n,i)}),console.log("starting auth init..."),s.initAuth().then(function(e){t.$broadcast(r.loginSuccess,e),console.log("auth init complete!")})}])},318:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(319),s=n(a),r=e(347),l=n(r),c=e(369),u=n(c),d=e(376),m=n(d),f=e(422),p=n(f),h=e(433),g=n(h);g.default.registerAll();var v=o.default.module("app.common",[s.default,l.default,u.default,m.default,p.default]).name;exports.default=v},319:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(310),l=n(r),c=e(320),u=n(c),d=o.default.module("buttonbar",[s.default,l.default]).component("buttonBar",u.default).constant("BUTTONBAR_VIEWS",{locations:{label:"By location",icon:"pin_drop",desc:"View a list of available tour locations"},map:{label:"By map",icon:"map",desc:"Explore locations from the UOIT Campus Map"},search:{label:"Search",icon:"search",desc:"Find specific Virtual Tour highlights"},settings:{label:"Settings",icon:"tune",desc:"Adjust the Virtual Tour experience"}}).name;exports.default=d},320:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(321),o=n(i),a=e(322),s=n(a);e(343);var r={template:o.default,controller:s.default,bindings:{items:"<",open:"<?",condensed:"<?",mobile:"<?"}};exports.default=r},321:function(t,exports){t.exports='<aside\n\tclass="button-bar"\n\tng-class="{\'collapsed\': $ctrl.condensed || $ctrl.mobile.screen}"\n\tng-if="$ctrl.open&&!($ctrl.mobile.landscape&&$ctrl.mobile.screen)"\n\tmd-whiteframe="2"\n\tlayout="row"\n\tlayout-gt-sm="column"\n\tlayout-align="start stretch"\n\tlayout-align-gt-sm="end end"\n\tflex="grow">\n\t<div ng-repeat="(state, stateInfo) in ::$ctrl.items"\n\t\tclass="button-bar-btn"\n\t\tng-class="{ \'is-active\': $ctrl.menuOpen && (state | isState)}"\n\t\tlayout="column"\n\t\tlayout-align="center center"\n\t\tflex="grow"\n  \tng-click="$ctrl.select(state)"\n  \tmd-ink-ripple="#0077CA"\n  \tid="{{::v}}">\n  \t<ng-md-icon icon="{{ :: stateInfo.icon }}" style="fill: #ffffff;"></ng-md-icon>\n    <span ng-bind=":: stateInfo.label"></span>\n    <md-tooltip md-direction="{{ $ctrl.mobile.screen ? \'top\' : \'left\' }}" md-autohide md-delay="$ctrl.condensed ? 0 : 750" ng-if="!$ctrl.mobile.device&&$ctrl.showHints()" md-z-index="10000">\n      {{ $ctrl.condensed ?  stateInfo.label :  stateInfo.desc }}\n    </md-tooltip>\n  </div>\n\t<div\n\t\tclass="button-bar-btn enter-vr"\n\t\tlayout="column"\n\t\tlayout-align="center center"\n\t\tflex="grow"\n\t\tflex-gt-sm="0"\n  \tng-click="$ctrl.enterVR()"\n  \tmd-ink-ripple="#0077CA"\n  \tid="enter-vr">\n  \t<svg viewBox="0 0 24 24"><!-- {{ $ctrl.condensed }} -->\n    \t<path d="M20.74,6H3.2C2.55,6 2,6.57 2,7.27V17.73C2,18.43 2.55,19 3.23,19H8C8.54,19 9,18.68 9.16,18.21L10.55,14.74C10.79,14.16 11.35,13.75 12,13.75C12.65,13.75 13.21,14.16 13.45,14.74L14.84,18.21C15.03,18.68 15.46,19 15.95,19H20.74C21.45,19 22,18.43 22,17.73V7.27C22,6.57 21.45,6 20.74,6M7.22,14.58C6,14.58 5,13.55 5,12.29C5,11 6,10 7.22,10C8.44,10 9.43,11 9.43,12.29C9.43,13.55 8.44,14.58 7.22,14.58M16.78,14.58C15.56,14.58 14.57,13.55 14.57,12.29C14.57,11.03 15.56,10 16.78,10C18,10 19,11.03 19,12.29C19,13.55 18,14.58 16.78,14.58Z" />\n\t\t</svg>\n    <md-tooltip md-direction="{{ $ctrl.mobile.screen ? \'top\' : \'left\' }}" md-autohide ng-if="!$ctrl.mobile.device&&$ctrl.showHints()">\n    \tSwitch to VR (fullscreen on desktop)\n    </md-tooltip>\n  </div>\n</aside>'},322:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n,i,a,s){"ngInject";(0,o.default)(this,t),this._$scope=e,this._$document=n,this._$state=i,this._$mdSidenav=a,this.showHints=function(){return s.settings.showHints.val}}return t.$inject=["$scope","$document","$state","$mdSidenav","UserSession"],(0,s.default)(t,[{key:"select",value:function(t){var e=this;return this.menuOpen&&this._$state.includes(t)?this._$mdSidenav("right").close().then(function(){return e._$state.transitionTo("home")}):this._$state.transitionTo(t).then(function(){e._$mdSidenav("right").open()})}},{key:"enterVR",value:function(){this._$document[0].getElementById("aframe-scene").enterVR()}},{key:"$onInit",value:function(){var t=this;this._$scope.$watch(function(){return t._$mdSidenav("right").isOpen()},function(e){t.menuOpen=e})}}]),t}();exports.default=r},343:function(t,exports){},347:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(310),s=n(a),r=e(348),l=n(r),c=e(355),u=n(c),d=e(358),m=n(d),f=e(363),p=n(f),h=e(368),g=n(h),v=o.default.module("popup",[s.default,l.default,u.default,m.default,p.default]).service("$popupWindow",g.default).name;exports.default=v},348:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(349),l=n(r),c=e(310),u=n(c),d=e(351),m=n(d),f=e(352),p=n(f);e(353);var h=o.default.module("popup.error",[s.default,l.default,u.default]).config(["$mdDialogProvider",function(t){"ngInject";t.addPreset("error",{options:function(){return{template:m.default,controller:p.default,controllerAs:"$ctrl",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0,parent:o.default.element(document.body)}}})}]).constant("ERROR_SUGGESTIONS",[{title:'Clear your <md-select \n\t\tstyle="display:inline-block;min-width:130px;"\n\t\tng-model="item.params"\n\t\tplaceholder="browser"\n\t\tclass="md-no-underline">\n\t  <md-option value="gc">Google Chrome</md-option>\n\t  <md-option value="ie">Internet Explorer</md-option>\n\t  <md-option value="ff">Firefox</md-option>\n\t  <md-option value="sa">Safari</md-option>\n\t  <md-option value="op">Opera</md-option>\n\t  <md-option value="other">Other browser</md-option>\n\t</md-select> cache',desc:"Clearing your browser cache is a non-invasive troubleshooting step that resolves many simple web issues.",icon:"delete_forever",action:function(t){var e="http://www.refreshyourcache.com";switch(t){case"gc":e="https://support.google.com/accounts/answer/32050";break;case"ie":e="https://support.microsoft.com/en-us/kb/260897";break;case"ff":e="https://support.mozilla.org/en-US/kb/how-clear-firefox-cache";break;case"sa":e="https://support.apple.com/en-us/HT204098";break;case"op":e="http://help.opera.com/opera/Windows/2256/en/private.html#deleteData"}window.open(e,"_blank")}},{title:"Wait a little while and try again",desc:"If the server is busy or not responding, it usually resolves itself after a short amount of time.",icon:"hourglass_empty"},{title:"Adjust the tour data usage settings",desc:"If the tour is taking too long to load, you can customize its loading behaviour to better suit your situation.",icon:"data_usage",goToSettings:!0},{title:"Double check the URL",desc:"Is the address of the page what you expected it to be? Ensure it starts with https:// and free of spelling errors.",icon:"hourglass_empty"},{title:"Refresh the page",desc:"If the page has encountered a minor issue but cannot proceed past it, refreshing the browser will often solve the issue.",icon:"hourglass_empty"}]).name;exports.default=h},351:function(t,exports){t.exports='<md-dialog class="error-message">\n\t<md-dialog-content>\n\n\t\t<md-tabs class="md-primary" md-selected="$ctrl.sendReport" md-align-tabs="{{data.bottom ? \'bottom\' : \'top\'}}" md-dynamic-height md-border-bottom>\n\n      <md-tab id="message" label="error">\n\n\t\t\t\t<md-content layout-padding>\n\t\t\t\t\t<h2 class="md-display-1">{{ $ctrl.type || \'Whoops!\' }}</h2>\n\t\t\t\t\t<p>{{ $ctrl.message || \'An unknown error occurred.\' }}</p>\n\n\t\t\t\t\t<span class="md-caption"><strong>Maybe try:</strong></span>\n\t\t\t\t</md-content>\n\t\t\t\t<md-list>\n\t\t\t\t\t<md-divider></md-divider>\n\n\t\t\t\t\t<md-list-item class="md-2-line md-long-text" ng-if="$ctrl.suggestions.length > 0" ng-repeat="item in ::$ctrl.suggestions">\n\t\t        <ng-md-icon icon="{{ ::item.icon }}" size="24" style="fill: #0077CA;"></ng-md-icon>\n\t\t        <div class="md-list-item-text" layout="column">\n\t\t          <h3 bind-html-compile compile="::item.title"></h3>\n\t\t          <p>{{ ::item.desc }}</p>\n\t\t        </div>\n\t\t        <md-button class="md-secondary md-primary" ng-if="::item.action||item.goToSettings" ng-click="::item.goToSettings ? $ctrl.goToSettings() : item.action(item.params)">Show me how</md-button>\n\t\t\t\t\t</md-list-item>\n\n\t\t\t\t\t<md-list-item class="md-2-line md-long-text" ng-click="$ctrl.sendReport = 1" md-autofocus>\n\t\t        <ng-md-icon icon="error" size="24" style="fill: #0077CA;"></ng-md-icon>\n\t\t        <div class="md-list-item-text" layout="column">\n\t\t          <h3>Send an error report</h3>\n\t\t          <p>Help us help you by reporting this error to the UOIT Webteam.</p>\n\t\t        </div>\n\t\t\t\t\t</md-list-item>\n\t\t\t\t</md-list>\n\n      </md-tab>\n\n      <md-tab id="report" label="send report" layout-padding>\n\n      </md-tab>\n\n    </md-tabs>\n\n\t</md-dialog-content>\n\t<md-dialog-actions>\n\n\t\t<md-button ng-click="$ctrl.refreshApp()" class="md-primary md-raised">\n\t\t\tRefresh page\n\t\t</md-button>\n\n\t\t<md-button ng-click="$ctrl.closeDialog()" class="md-primary">\n\t\t\tClose and try again\n\t\t</md-button>\n\n\t</md-dialog-actions>\n</md-dialog>'},352:function(t,exports){"use strict";function e(t,e,n,i,o,a){"ngInject";var s=this;this.suggestions=[],this.suggest&&this.suggest.length&&this.suggest.forEach(function(t){s.suggestions.push(a[t])}),this.closeDialog=function(){t.reload(),o.hide()},this.goToSettings=function(){o.hide(),t.go("settings"),i("right").open()},this.refreshApp=function(){n.location.reload()},this.stopProp=function(t){t.stopPropagation()}}e.$inject=["$state","$sce","$window","$mdSidenav","$mdDialog","ERROR_SUGGESTIONS"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},353:function(t,exports){},355:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(349),l=n(r),c=e(310),u=n(c),d=e(356),m=n(d),f=e(357),p=n(f),h=o.default.module("popup.info",[s.default,l.default,u.default]).config(["$mdDialogProvider",function(t){"ngInject";t.addPreset("info",{options:function(){return{template:m.default,controller:p.default,parent:o.default.element(document.body),controllerAs:"$ctrl",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0}}})}]).name;exports.default=h},356:function(t,exports){t.exports='<md-dialog class="login-message">\n\t<md-dialog-content>\n\t\t<md-content layout-padding>\n\t\t\t<h2 class="md-display-1" ng-if="$ctrl.name">{{ ::$ctrl.name }}</h2>\n\t\t\t<h2 class="md-subhead" ng-if="$ctrl.href"><a ng-href="{{ ::$ctrl.href }}">Learn more at {{ ::$ctrl.href }} &raquo;</a></h2>\n\t\t\t<div ng-bind-html="$ctrl.desc" ng-if="$ctrl.desc">\n\t\t\t</div>\n\t\t</md-content>\n\t</md-dialog-content>\n\t<md-dialog-actions>\n\t\t<md-button ng-click="$ctrl.viewInTour()" class="md-primary md-raised" ng-if="$ctrl.type === \'feature\'">\n\t\t\tView in Virtual Tour\n\t\t</md-button>\n\t\t<md-button ng-click="$ctrl.viewOnMap()" class="md-primary md-raised" ng-if="$ctrl.type === \'hotspot\'">\n\t\t\tView on Campus Map\n\t\t</md-button>\n\t\t<md-button ng-click="$ctrl.closeDialog()" class="md-primary">\n\t\t\tClose\n\t\t</md-button>\n\t</md-dialog-actions>\n</md-dialog>'},357:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n,i,a){"ngInject";(0,o.default)(this,t),this.$state=e,this.$sce=n,this.$mdSidenav=i,this.$mdDialog=a}return t.$inject=["$state","$sce","$mdSidenav","$mdDialog"],(0,s.default)(t,[{key:"closeDialog",value:function(){this.$mdDialog.hide()}},{key:"viewOnMap",value:function(){this.$mdDialog.hide(),this.$state.go("map"),this.$mdSidenav("right").open()}},{key:"viewInTour",value:function(){this.$mdDialog.hide(),this.$state.go("building"),this.$mdSidenav("right").close()}}]),t}();exports.default=r},358:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(310),s=n(a),r=e(359),l=n(r),c=e(360),u=n(c);e(361);var d=o.default.module("popup.login",[s.default]).config(["$mdDialogProvider",function(t){"ngInject";t.addPreset("login",{options:function(){return{template:l.default,controller:u.default,parent:o.default.element(document.body),controllerAs:"$ctrl",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0}}})}]).name;exports.default=d},359:function(t,exports){t.exports='<md-dialog class="login-message">\n\t<md-dialog-content>\n\t\t<div layout="column" layout-padding>\n\t\t  <div layout="column" layout-align="center center" ng-if="!$ctrl.state.attempt">\n\t\t  \t<h2>Please sign in</h2>\n\t\t    <md-input-container class="md-icon-float md-icon-left md-block">\n\t\t      <label>User name</label>\n\t\t      <ng-md-icon icon="person_outline"></ng-md-icon>\n\t\t      <input ng-model="$ctrl.username"/>\n\t\t    </md-input-container>\n\n\t\t    <md-input-container class="md-icon-float md-icon-left md-block">\n\t\t      <label>Password</label>\n\t\t      <ng-md-icon icon="lock_outline"></ng-md-icon>\n\t\t      <input ng-model="$ctrl.password" type="password">\n\t\t    </md-input-container>\n\t\t    \n\t\t    <md-button class="md-raised md-primary" ng-click="$ctrl.login()">Sign in</md-button>\n\t\t  </div>\n\n\t\t  <div layout="column" layout-align="center center" ng-if="$ctrl.state.attempt && !($ctrl.state.success || $ctrl.state.failed)">\n\t\t\t  <md-progress-circular md-mode="indeterminate" md-diameter="56" style="margin: 10% auto"></md-progress-circular>\n\t\t  \t<h2>Logging in, please wait...</h2>\n\t\t  </div>\n\t\t  <div layout="column" layout-align="center center" ng-if="$ctrl.state.attempt && $ctrl.state.success">\n\t\t  \t<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t  \t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t  \t\t<path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>\n\t\t  \t</svg>\n\t\t  \t<h2>Logged in successfully!</h2>\n\t\t  </div>\n\t\t  <div layout="column" layout-align="center center" ng-if="$ctrl.state.attempt && $ctrl.state.failed">\n\t\t  \t<h2>Login failure! Please try again.</h2>\n\t\t  </div>\n\t\t</div>\n\t</md-dialog-content>\n<!-- \t<md-dialog-actions>\n\t\t<md-button ng-click="refreshApp()" class="md-primary md-raised">\n\t\t\tRefresh page\n\t\t</md-button>\n\t\t<md-button ng-click="closeDialog()" class="md-primary">\n\t\t\tClose and try again\n\t\t</md-button>\n\t</md-dialog-actions> -->\n</md-dialog>'},360:function(t,exports){"use strict";function e(t,e,n,i,o,a){"ngInject";var s=this;this.state={attempt:!1,success:!1,failed:!1},this.login=function(){if(!s.state.attempt){var n=s.username,r=s.password;if(!n||!r)return;s.state.attempt=!0,o.login({username:n,password:r}).then(function(n){t.$broadcast(a.loginSuccess,n),s.state.success=!0,e(function(){i.hide()},2e3)},function(){t.$broadcast(a.loginFailed),s.state.failed=!0,e(function(){s.state.attempt=!1},2e3)})}},this.logout=function(){o.logout()}}e.$inject=["$rootScope","$timeout","$window","$mdDialog","UserAuth","AUTH_EVENTS"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},361:function(t,exports){},363:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(310),s=n(a),r=e(364),l=n(r),c=e(365),u=n(c);e(366);var d=o.default.module("popup.welcome",[s.default]).config(["$mdDialogProvider",function(t){"ngInject";t.addPreset("welcome",{options:function(){return{template:l.default,controller:u.default,parent:o.default.element(document.body),controllerAs:"$ctrl",bindToController:!0,clickOutsideToClose:!0,openFrom:{top:18,left:18,width:36,height:60},closeTo:{top:18,left:18,width:36,height:60}}}})}]).constant("TOUR_STEPS",{config:{mask:{visible:!0,clickThrough:!1,clickExit:!0,scrollThrough:!1,color:"rgba(0,60,113,.7)"},container:"body",scrollBox:"body",previousText:"Previous",nextText:"Next",finishText:"Finish",animationDuration:400,dark:!0},steps:[{target:"#locations",placementPriority:["top","left","bottom","right"],content:"<h3>This is the location menu.</h3>UOIT locations can be explored manually using an expanding location menu. <strong>Click this button to open it!</strong>"},{target:"#map",placementPriority:["left","top","bottom","right"],content:"<h3>Explore locations on the campus map!</h3>The same locations featured above are layed out on an <strong>interactive map, available in this menu</strong>."},{target:"#search",placementPriority:["left","top","bottom","right"],content:"<h3>Not sure where to start?</h3>If you have an idea of something you're looking for, <strong>try searching for it</strong>."},{target:"#toolbar-controls",placementPriority:["bottom","left","right","top"],content:"The button toolbar below and to the right can be <strong>expanded, condensed, or hidden entirely</strong> with the buttons to the right-hand side here.<br/><br/>Don' forget to <strong>register your user account</strong> for future visits or <strong>book a real tour</strong> at the university!"},{target:"#settings",placementPriority:["left","top","bottom","right"],content:"If you want your preferences saved for future visits, you can <strong>configure your own personal settings</strong> for the Virtual Tour experience here!"},{placementPriority:["bottom","top","left","right"],content:'Would you like to learn how to navigate through <strong>scenes</strong>?<br/><div class="text-center" layout-margin><md-button class="md-raised md-primary">Show me how</md-button><md-button>No thanks</md-button></div>'}]}).constant("WELCOME_TIPS",{navigation:{title:["Learn how to","Navigate the Tour!"],tips:[{label:"Scene links",image:"images/tip-scene_link.gif",content:'<p class="md-body-1">Around the Tour, you will find many <strong>blue arrows</strong> <ng-md-icon icon="near_me" size="14" style="fill:#0077CA"></ng-md-icon>\n\t\t\t\tpointing to different areas. They are called <strong>scene links</strong>; use them to travel.\n\t\t\t\t<p class="md-body-1">Move your cursor over a scene link to highlight it, and click it to travel in the\n\t\t\t\tdirection it\'s pointing.'},{label:"Location menu",image:"images/tip-location_menu.gif",content:'<p class="md-body-1">The <ng-md-icon icon="pin_drop" size="14" style="fill:#666"></ng-md-icon> button \n\t\t\t\ton the far-right bar opens the <strong>location menu</strong>.</p>\n\t\t\t\t<p class="md-body-1">Navigate by picking a location; choose a building to list scenes\n\t\t\t\tfrom; click a scene to view it.</p>\n\t\t\t\t<p class="md-body-1">Use this menu to jump to a scene or between far-away scenes. Close\n\t\t\t\tthe menu by clicking the <ng-md-icon icon="pin_drop" size="14" style="fill:#666"></ng-md-icon> button again.</p>'},{label:"Campus map",image:"images/tip-campus_map.gif",content:'<p class="md-body-1">The Tour\'s built-in <strong>Campus Map</strong> can be used to navigate the Tour.</p>\n\t\t\t\t<p class="md-body-1">The <ng-md-icon icon="map" size="14" style="fill:#666"></ng-md-icon> button \n\t\t\t\ton the far-right bar opens the Map.\n\t\t\t\t<p class="md-body-1">Choose a building on the map by clicking it; click the <strong>Take a tour »</strong> button\n\t\t\t\tin the building info to go to that building\'s first scene.'}]},poi:{title:""}}).constant("WELCOME_TIP_LIST",[[{title:"Tour navigation",icon:"my_location",link:"navigation",desc:"Learn how to use warp arrows, map view and the location menu to move from scene to scene."},{title:"Points of interest",icon:"place",link:"",desc:"See which tour elements offer interactivity and how to use them."}],[{title:"Virtual reality",icon:"3d_rotation",link:"",desc:"Experience the UOIT virtual tour immersively with an Oculus© Rift."},{title:"Mobile VR",icon:"screen_rotation",link:"",desc:"Turn your smartphone into a portal to UOIT with a mobile VR peripheral like HTC Vive, Samsung Gear or Google Cardboard."},{title:"Customization",icon:"settings",link:"",desc:"Learn about the options available for fine-tuning the virtual tour interface."}]]).name;exports.default=d},364:function(t,exports){t.exports='<md-dialog aria-label="Welcome to the UOIT Virtual Tour" class="welcome-dialog">\n\t<form>\n\t\t<!-- TOOLBAR / TITLE / CLOSE BUTTON -->\n\t\t<md-toolbar>\n\t\t\t<div class="md-toolbar-tools">\n\t\t\t\t<h2>UOIT Virtual Tour</h2>\n\t\t\t\t<span flex></span>\n\t\t\t\t<md-button ng-if="!$ctrl.currentTips" class="md-icon-button" ng-click="$ctrl.cancel()" aria-label="Close this window">\n\t\t\t\t\t<ng-md-icon\n\t\t\t\t\t\ticon="close"\n\t\t\t\t\t\tstyle="fill: white;">\n\t\t\t\t\t</ng-md-icon>\n\t\t\t\t</md-button>\n\t\t\t</div>\n\t\t</md-toolbar>\n\n\t\t<!-- STANDARD: WELCOME TABS DISPLAY -->\n\t\t<md-dialog-content ng-if="!$ctrl.currentTips">\n\t\t\t<md-tabs\n\t\t\t\tmd-dynamic-height\n\t\t\t\tmd-border-bottom\n\t\t\t\tmd-center-tabs>\n\t\t\t\t<!-- WELCOME -->\n\t\t\t\t<md-tab label="Welcome">\n\t\t\t\t\t<md-content class="md-padding" layout="column" layout-align="start center">\n<!-- \t\t\t\t\t\t<ng-md-icon\n\t\t\t\t\t\t\tclass="dialog-icon compass-icon"\n\t\t\t\t\t\t\ticon="explore"\n\t\t\t\t\t\t\tsize="90"\n\t\t\t\t\t\t\tstyle="fill: #0077CA;">\n\t\t\t\t\t\t</ng-md-icon> -->\n\t\t\t\t\t\t<div class="dialog-icon compass-icon">\n\t\t\t\t\t\t\t<!-- <img src="images/uoit-shield.svg"> -->\n\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 84.86">\n\t\t\t\t\t\t\t  <path d="M43.82,82.91c-17.6,0-25.67-15.73-25.67-31.62s8.07-31.62,25.67-31.62c13.27,0,21.11,8.93,24.18,20.15L67.94,0H0L0,51C.71,70.93,15.27,84.86,34,84.86a28.57,28.57,0,0,0,10-2Z" style="fill: #0077ca"/>\n\t\t\t\t\t\t\t  <path d="M43.89,22.17c-14.13,0-15.16,19.16-15.16,29.2s1,29.21,15.16,29.21S59,61.42,59,51.37,58,22.17,43.89,22.17Z" style="fill: #0077ca"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h2 class="md-display-2">Welcome to the Virtual Tour!</h2>\n\t\t\t\t\t\t<p class="md-headline">Experience an immersive 3D visit to the University of Ontario Institute of Technology.</p>\n\t\t\t\t\t\t<p class="md-headline">Use the tabs above to learn more about how to use the Virtual Tour, or just dive in!<br/>You\'ll learn quickly.</p>\n\t\t\t\t\t</md-content>\n\t\t\t\t</md-tab>\n\t\t\t\t<!-- USAGE TIPS -->\n\t\t\t\t<md-tab label="Usage tips">\n\t\t\t\t\t<md-content class="md-padding" layout="column">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<ng-md-icon\n\t\t\t\t\t\t\t\tclass="dialog-icon tips-icon"\n\t\t\t\t\t\t\t\ticon="live_help"\n\t\t\t\t\t\t\t\tsize="90"\n\t\t\t\t\t\t\t\tstyle="fill: #0077CA;">\n\t\t\t\t\t\t\t</ng-md-icon>\n\t\t\t\t\t\t\t<h2><span class="md-display-2">Tips</span><br/><span class="md-headline">for better usage</span></h2>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div layout="row">\n\t\t\t\t\t\t\t<md-list flex>\n\t\t\t\t\t\t\t\t<md-subheader class="md-no-sticky">First steps</md-subheader>\n\t\t\t\t\t\t\t\t<md-divider ></md-divider>\n\t\t\t\t\t\t\t\t<md-list-item class="md-2-line md-long-text" ng-repeat="tips in ::$ctrl.welcomeTipsList[0]" ng-click="$ctrl.viewTip(tips.link)" layout="row">\n\t\t\t\t\t\t\t\t\t<ng-md-icon icon="{{ ::tips.icon }}" size="24" style="fill: #0077CA;"></ng-md-icon>\n\t\t\t\t\t\t\t\t\t<div class="md-list-item-text" layout="column">\n\t\t\t\t\t\t\t\t\t\t<h3>{{ ::tips.title }}</h3>\n\t\t\t\t\t\t\t\t\t\t<p>{{ ::tips.desc }}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</md-list-item>\n\t\t\t\t\t\t\t</md-list>\n\t\t\t\t\t\t\t<md-list flex>\n\t\t\t\t\t\t\t\t<md-subheader class="md-no-sticky">Digging deeper</md-subheader>\n\t\t\t\t\t\t\t\t<md-divider ></md-divider>\n\t\t\t\t\t\t\t\t<md-list-item class="md-2-line md-long-text" ng-repeat="tips in ::$ctrl.welcomeTipsList[1]" ng-click="$ctrl.viewTip(tips.link)" layout="row">\n\t\t\t\t\t\t\t\t\t<ng-md-icon icon="{{ ::tips.icon }}" size="24" style="fill: #0077CA;"></ng-md-icon>\n\t\t\t\t\t\t\t\t\t<div class="md-list-item-text" layout="column">\n\t\t\t\t\t\t\t\t\t\t<h3>{{ ::tips.title }}</h3>\n\t\t\t\t\t\t\t\t\t\t<p>{{ ::tips.desc }}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</md-list-item>\n\t\t\t\t\t\t\t</md-list>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</md-content>\n\t\t\t\t</md-tab>\n\t\t\t\t<!-- ACCESSIBILITY -->\n\t\t\t\t<md-tab label="Accessibility">\n\t\t\t\t\t<md-content class="md-padding" layout="column">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<ng-md-icon\n\t\t\t\t\t\t\t\tclass="dialog-icon access-icon"\n\t\t\t\t\t\t\t\ticon="accessibility"\n\t\t\t\t\t\t\t\tsize="90"\n\t\t\t\t\t\t\t\tstyle="fill: #0077CA;">\n\t\t\t\t\t\t\t</ng-md-icon>\n\t\t\t\t\t\t\t<h2><span class="md-display-2">Accessibility</span><br/><span class="md-headline">information</span></h2>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</md-content>\n\t\t\t\t</md-tab>\n\t\t\t</md-tabs>\n\t\t</md-dialog-content>\n\n\t\t<!-- INCLUDE: ACTIVE TIP DISPLAY -->\n\t\t<md-dialog-content ng-if="$ctrl.currentTips">\n\t\t\t<div layout layout-align="center center">\n\t\t\t\t<md-button class="md-primary" ng-click="$ctrl.currentTips = false">« Go back</md-button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<h2 layout-padding>\n\t\t\t\t\t<span class="md-headline">{{ ::$ctrl.currentTips.title[0] }}</span><br/>\n\t\t\t\t\t<span class="md-display-2">{{ ::$ctrl.currentTips.title[1] }}</span>\n\t\t\t\t</h2>\n\t\t\t</div>\n\t\t\t<md-tabs\n\t\t\t\tmd-dynamic-height\n\t\t\t\tmd-border-bottom\n\t\t\t\tmd-center-tabs\n\t\t\t\tmd-selected="$ctrl.activeTip">\n\t\t\t\t<!-- md-stretch-tabs="always" -->\n\n\t\t\t  <md-tab ng-repeat="tip in ::$ctrl.currentTips.tips" label="{{ ::tip.label }}">\n\t\t\t    <md-content layout="column"> \n\t\t\t\t    <div layout="row" layout-padding> \n\t\t\t\t\t  \t<div bind-html-compile compile="::tip.content" layout="column" layout-align="center center" flex>\n\t\t\t\t\t  \t</div>\n\t\t\t\t\t  \t<img ng-src="{{ ::tip.image }}" flex>\n\t\t\t\t  \t</div>\n\t\t\t    </md-content>\n\t\t\t  </md-tab>\n\t\t\t</md-tabs>\n\t\t</md-dialog-content>\n\n\t\t<!-- TIP DISPLAY PREV/NEXT BUTTONS -->\n\t\t<md-dialog-actions ng-if="$ctrl.currentTips" layout layout-align="space-between center">\n\t\t\t<md-button class="md-primary" ng-click="$ctrl.prevTip()">« Previous</md-button>\n\t\t\t<md-button class="md-primary" ng-click="$ctrl.nextTip()">Next »</md-button>\n\t\t</md-dialog-actions>\n\t\t\n\t\t<!-- WELCOME TOUR/DISMISSAL -->\n\t\t<md-dialog-actions layout="row" class="footer-pane" ng-if="!$ctrl.currentTips">\n\t\t\t<md-checkbox class="md-primary" aria-label="Permanently dismiss this dialog" md-autofocus ng-model="$ctrl.showWelcome" ng-true-value="false" ng-false-value="true" ng-change="$ctrl.syncSettings()">\n\t\t\t\t<strong>Don\'t show me this again</strong>\n\t\t\t</md-checkbox>\n\t\t\t<span flex></span>\n\t\t\t<md-button class="md-raised md-primary" ng-click="$ctrl.startTour()">\n\t\t\t\tTake an interactive tour\n\t\t\t</md-button>\n\t\t\t<md-button class="md-primary" ng-click="$ctrl.hide()" style="margin-right:20px;" >\n\t\t\t\tNo thanks\n\t\t\t</md-button>\n\t\t</md-dialog-actions>\n\t</form>\n</md-dialog>'},365:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n,i,a,s){"ngInject";(0,o.default)(this,t),this.$mdDialog=e,this.UserSession=n,this.OnboardTour=function(){return alert("fix me!")},this.TOUR_STEPS=i,this.WELCOME_TIPS=s,this.welcomeTipsList=a,this.currentTips=!1}return t.$inject=["$mdDialog","UserSession","TOUR_STEPS","WELCOME_TIP_LIST","WELCOME_TIPS"],(0,s.default)(t,[{key:"hide",value:function(){return this.$mdDialog.hide()}},{key:"cancel",value:function(){return this.$mdDialog.cancel()}},{key:"answer",value:function(t){return this.$mdDialog.hide(t)}},{key:"viewTip",value:function(t){console.log(this.WELCOME_TIPS[t]),this.currentTips=this.WELCOME_TIPS[t]}},{key:"nextTip",value:function(){this.activeTip=this.activeTip===this.currentTips.tips.length-1?0:this.activeTip+1}},{key:"prevTip",value:function(){this.activeTip=0===this.activeTip?this.currentTips.tips.length-1:this.activeTip-1}},{key:"startTour",value:function(){return this.$mdDialog.hide("tour"),this.OnboardTour.start(this.TOUR_STEPS)}},{key:"syncSettings",value:function(){var t=this.UserSession.settings;t.showWelcome.val=this.showWelcome,this.UserSession.settings=t}}]),t}();exports.default=r},366:function(t,exports){},368:function(t,exports,e){"use strict";
function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n){"ngInject";(0,o.default)(this,t),this.$mdDialog=e,this.$mdToast=n,this.standardToast=n.simple().action("Dismiss").hideDelay(5e3).highlightAction(!0).highlightClass("md-warn").position("bottom left")}return t.$inject=["$mdDialog","$mdToast"],(0,s.default)(t,[{key:"welcome",value:function(){return this.$mdDialog.show(this.$mdDialog.welcome())}},{key:"login",value:function(){return this.$mdDialog.show(this.$mdDialog.login())}},{key:"info",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.locals,n=void 0===e?null:e;return this.$mdDialog.show(this.$mdDialog.info({locals:n}))}},{key:"toast",value:function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary",n=arguments[1],i=n.message,o=n.action,a=void 0===o?"Dismiss":o,t=this.standardToast.textContent(i).action(a).highlightClass("md-"+e);return this.$mdToast.show(t)}},{key:"error",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.locals,n=void 0===e?null:e;return this.$mdDialog.show(this.$mdDialog.error({locals:n}))}},{key:"warning",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.locals,n=void 0===e?{message:"An unknown error occurred!",action:"Dismiss"}:e,i=this.standardToast.textContent(n.message||"An unknown error occurred!").action(n.action||"Dismiss").position("bottom right");return this.$mdToast.show(i)}}]),t}();exports.default=r},369:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(310),s=n(a),r=e(370),l=n(r),c=e(374),u=n(c),d=o.default.module("titlebar",[s.default]).component("titleBar",l.default).directive("titleBarButton",u.default).constant("TITLEBAR_OPTS",{register:{active:!0,label:"Register now",tooltip:!1,icon:["person_outline","person_outline"],class:"cta-button bg-pink"},schedule:{active:!0,label:"Schedule visit",tooltip:!1,icon:["add_alarm","add_alarm"],class:"cta-button bg-green"},apply:{active:!0,label:"Apply online",tooltip:!1,icon:["bookmark_outline","bookmark_outline"],class:"cta-button bg-orange"},condense:{active:!0,label:"Toolbar size",tooltip:["Expand toolbar","Condense toolbar"],icon:["flip_to_front","flip_to_back"]},right:{active:!0,label:"Toolbar visibility",tooltip:["Hide toolbar","Show toolbar"],icon:["last_page","first_page"]}}).name;exports.default=d},370:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(371),o=n(i);e(372);var a={template:o.default,transclude:!0,bindings:{title:"@",mobile:"<"}};exports.default=a},371:function(t,exports){t.exports='<md-toolbar class="md-accent md-hue-1 title-bar" layout="row" ng-class="{\'is-mobile\' : $ctrl.mobile.screen}">\n\n  <md-toolbar-filler flex="nogrow" layout layout-align="start center" layout-align-gt-sm="center center">\n<!--     <img ui-sref="home" src="images/uoit-shield.svg" alt="University of Ontario Institute of Technology" class="logo-shield" id="uoit_logo"> -->\n    <svg ui-sref="home" alt="University of Ontario Institute of Technology" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 84.86" class="logo-shield" id="uoit_logo" preserveAspectRatio="xMaxYMax meet">\n\t\t  <path d="M43.82,82.91c-17.6,0-25.67-15.73-25.67-31.62s8.07-31.62,25.67-31.62c13.27,0,21.11,8.93,24.18,20.15L67.94,0H0L0,51C.71,70.93,15.27,84.86,34,84.86a28.57,28.57,0,0,0,10-2Z"/>\n\t\t  <path d="M43.89,22.17c-14.13,0-15.16,19.16-15.16,29.2s1,29.21,15.16,29.21S59,61.42,59,51.37,58,22.17,43.89,22.17Z"/>\n\t\t</svg>\n  </md-toolbar-filler>\n\n  <div class="md-toolbar-tools" ng-if="!$ctrl.mobile.screen">\n    <h1 ui-sref="locations">{{::$ctrl.title}} <small class="beta-label">BETA</small></h1>\n    <span flex></span>\n    <ng-transclude id="toolbar-controls" layout layout-align="center center"></ng-transclude>\n  </div>\n\n</md-toolbar>'},372:function(t,exports){},374:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){"ngInject";return{template:a.default,require:"^titleBar",scope:{onClick:"&",label:"@",class:"@",active:"<",tooltip:"<",icon:"<"}}}i.$inject=["$log"],Object.defineProperty(exports,"__esModule",{value:!0});var o=e(375),a=n(o);exports.default=i},375:function(t,exports){t.exports='<md-button\n\tclass="icon-button {{ ::class }}"\n\tng-click="onClick()"\n\tng-class="{ \'active\': active }"\n\taria-label="{{ ::label }}">\n  <ng-md-icon\n  \ticon="{{ active ? icon[0] || icon : icon[1] || icon }}"\n  \tstyle="fill: currentColor;">\n  </ng-md-icon>\n  <md-tooltip md-direction="bottom" md-autohide ng-if="tooltip && !(mc.mobile||!$ctrl.settings.showHints.val)">\n    {{ active ? (tooltip[0] || tooltip) : (tooltip[1] || tooltip) }}\n  </md-tooltip>\n\t<span ng-if="::(!tooltip)">{{ ::label }}</span>\n</md-button>'},376:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(377),l=n(r),c=e(416),u=n(c),d=e(417),m=n(d),f=o.default.module("user",[s.default]).factory("UserAuth",l.default).factory("UserResolver",u.default).service("UserSession",m.default).constant("USER_DEFAULTS",{settings:{toolbarOpen:{val:!0,label:"Toolbar open by default",icon:"last_page"},toolbarCondensed:{val:!1,label:"Toolbar condensed by default",icon:"flip_to_back"},showHints:{val:!0,label:"Show hint messages",icon:"announcement"},showWelcome:{val:!0,label:"Always show welcome",icon:"live_tv"}},usage:{auto:{val:!0},compression:{val:1,min:1,max:5,step:1,label:"Compression level",labels:["Less","More"],levels:{"<= 2":[10,5,10],"== 3":[5,5,5],">= 4":[0,10,0]}},preloading:{val:0,min:0,max:2,step:1,label:"Preloading strategy",labels:["None","Proactive"],levels:{"== 0":[5,10,0],"== 1":[5,5,5],"== 2":[5,0,5]}},resolution:{val:1,min:0,max:1,step:1,label:"Image resolution",labels:["Low","High"],levels:{"== 0":[0,0,0],"== 1":[10,5,10]}}},profiles:{conserve:{auto:{val:!0},compression:{val:5},preloading:{val:0},resolution:{val:0}},balanced:{auto:{val:!0},compression:{val:3},preloading:{val:1},resolution:{val:1}},mobile3g:{auto:{val:!0},compression:{val:4},preloading:{val:1},resolution:{val:0}},mobileWifi:{auto:{val:!0},compression:{val:2},preloading:{val:1},resolution:{val:0}},desktopSlow:{auto:{val:!0},compression:{val:5},preloading:{val:2},resolution:{val:1}},desktopFast:{auto:{val:!0},compression:{val:1},preloading:{val:2},resolution:{val:1}}}}).constant("USER_ROLES",{admin:"admin",editor:"editor",contributor:"contributor"}).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).name;exports.default=f},377:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){"ngInject";var n=this;return this.createSession=function(t){return console.log("starting session creation..."),e.create(t)},this.initAuth=function(){return console.log("checking for user..."),t.get("/user/me").then(function(t){return console.log("user found"),n.createSession(t.data.user)}).catch(function(t){return console.log("user not found"),n.createSession(!1)})},this.login=function(e){var i=e.username,o=e.password;return t.post("/user/signin",{username:i,password:o}).then(function(t){return n.createSession(t.data.user)})},this.logout=function(){return t.post("/user/signout").then(function(t){e.destroy(),console.log("user logged out")},function(t){console.log("error, user not logged out")})},this.isAuthenticated=function(){return!!e.userId},this.isAuthorized=function(t){if(!t||0===t.length)return!0;(0,s.isArray)(t)||(t=[t]);var i=!1,o=!0,r=!1,l=void 0;try{for(var c,u=(0,a.default)(e.roles);!(o=(c=u.next()).done);o=!0){var d=c.value;t.indexOf(d)!==-1&&(i=!0)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}return n.isAuthenticated()&&i},this}i.$inject=["$http","UserSession"],Object.defineProperty(exports,"__esModule",{value:!0});var o=e(378),a=n(o),s=e(299);exports.default=i},416:function(t,exports){"use strict";function e(t,e,n,i){return{resolve:function(){var o=t.defer(),a=e.$watch(function(){return i.user},function(t){angular.isDefined(t)&&(t?o.resolve(t):(o.reject(),n.go("login")),a())});return o.promise}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},417:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(418),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=e(299),u=function(){function t(e,n,i,o,a){"ngInject";(0,s.default)(this,t),this.$http=e,this.$popupWindow=n,this.SettingsFactory=i,this._roles=o,this._settings=a.settings,this._usage=a.usage,this.user={}}return t.$inject=["$http","$popupWindow","SettingsFactory","USER_ROLES","USER_DEFAULTS"],(0,l.default)(t,[{key:"create",value:function(t){if(this.roles=[],t){this.userId=t._id,this.user=t;var e=t.isAdmin,n=t.isEditor,i=t.isContributor;e&&this.roles.push(this._roles.admin),n&&this.roles.push(this._roles.editor),i&&this.roles.push(this._roles.Contributor),console.log("created session from user")}else{var o=this.SettingsFactory.get("settings"),a=this.SettingsFactory.get("usage");this.user={settings:{},usage:{}},this.settings=o&&!(0,c.equals)(o,{})?o:this._settings,this.usage=a&&!(0,c.equals)(a,{})?a:this._usage,console.log("created session from local defaults",o)}return this.user}},{key:"save",value:function(){var t=this;console.log("saving settings to user..."),this.userId?this.$http.post("/user/save",this.user).then(function(e){t.$popupWindow.toast("primary",{message:"User settings updated!",action:"Dismiss"}),console.log("saved settings to user!")}):(this.SettingsFactory.set("settings",this.settings),this.SettingsFactory.set("usage",this.usage),console.log("saved settings to local!",this.user))}},{key:"destroy",value:function(){this.user={settings:{},usage:{}},this.roles=null,this.userId=null,console.log("user session destroyed")}},{key:"settings",get:function(){var t=this;if(this.user.settings)return(0,o.default)(this.user.settings).map(function(e){t._settings[e]&&(t._settings[e].val=t.user.settings[e])}),this._settings},set:function(t){var e=this;(0,c.isDefined)(t)&&((0,o.default)(t).map(function(n){e._settings[n]&&(e.user.settings[n]=t[n].val)}),this.save())}},{key:"usage",get:function(){var t=this;if(this.user.usage)return(0,o.default)(this.user.usage).map(function(e){t._usage[e]&&(t._usage[e].val=t.user.usage[e])}),this._usage},set:function(t){var e=this;(0,c.isDefined)(t)&&((0,o.default)(t).map(function(n){e._usage[n]&&(e.user.usage[n]=t[n].val)}),this.save())}}]),t}();exports.default=u},422:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(423),s=n(a),r=e(425),l=n(r),c=e(427),u=n(c),d=o.default.module("util",[s.default,l.default,u.default]).name;exports.default=d},423:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(424),s=n(a),r=o.default.module("util.dom",[]).directive("bindHtmlCompile",s.default).name;exports.default=r},424:function(t,exports){"use strict";function e(t){"ngInject";return function(e,n,i){var o=e.$watch(function(t){return t.$eval(i.compile)},function(i){n.html(i),t(n.contents())(e),o()})}}e.$inject=["$compile"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},425:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(426),s=n(a),r=o.default.module("util.model",[]).directive("toNumber",s.default).name;exports.default=r},426:function(t,exports){"use strict";function e(){return{restrict:"A",require:"ngModel",link:function(t,e,n,i){i.$parsers.push(function(t){return""+t}),i.$formatters.push(function(t){return parseFloat(t)})}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},427:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(428),s=n(a),r=e(430),l=n(r),c=e(431),u=n(c),d=e(432),m=n(d),f=o.default.module("util.resource",[s.default]).factory("DraftResource",l.default).factory("$mapApi",u.default).factory("$tourApi",m.default).constant("GLOBAL_SETTINGS",{apiUrl:"/api/v1",imageApiUrl:"//res.cloudinary.com/uoit-virtual-tour/image/upload"}).name;exports.default=f},430:function(t,exports){"use strict";function e(t,e){"ngInject";return t(e.apiUrl+"/drafts/:id",null,{update:{method:"PATCH"}})}e.$inject=["$resource","GLOBAL_SETTINGS"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},431:function(t,exports){"use strict";function e(t,e){"ngInject";return{category:t(e.apiUrl+"/categories/:id"),feature:t(e.apiUrl+"/features/:id"),collection:t(e.apiUrl+"/feature-collections/:id")}}e.$inject=["$resource","GLOBAL_SETTINGS"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},432:function(t,exports){"use strict";function e(t,e){"ngInject";return{location:t(e.apiUrl+"/locations/:id"),building:t(e.apiUrl+"/buildings/:id"),scene:t(e.apiUrl+"/scenes/:id",null,{update:{method:"PATCH"}}),preload:t(e.apiUrl+"/scenes/:id/preload",null,{get:{method:"GET",isArray:!0}}),entity:t(e.apiUrl+"/entities/:id")}}e.$inject=["$resource","GLOBAL_SETTINGS"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},433:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0}),e(434),e(435),e(437),e(438);var i=e(439),o=e(544),a=n(o),s=e(545),r=n(s),l=e(546),c=n(l),u=e(547),d=n(u),m=e(548),f=n(m),p=e(549),h=n(p),g=e(550),v=n(g),b=e(571),y=n(b);exports.default={sceneLink:a.default,hotSpot:r.default,textPanel:c.default,hoverAnimation:d.default,levelScaleTo:f.default,hitBox:h.default,delegateEvent:v.default,anchorLook:y.default,registerAll:function(){i.loaders.registerAll(),i.primitives.registerAll(),y.default.register(),v.default.register(),h.default.register(),f.default.register(),d.default.register(),c.default.register(),r.default.register(),a.default.register()}}},544:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i="scene-link",o={config:{defaultComponents:{geometry:{primitive:"cone",height:.5,radiusBottom:.5,radiusTop:0,segmentsHeight:1,segmentsRadial:4},scale:{x:.1,y:1,z:1},animation:{property:"position",dir:"alternate",dur:1200,easing:"easeInOutSine",from:"0 0 0",to:"0 -0.1 0",loop:!0}}},register:function(){(0,n.registerPrimitive)(i,n.utils.extendDeep(n.primitives.getMeshMixin(),this.config))}};exports.default=o},545:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i={config:{defaultComponents:{geometry:{arc:360,primitive:"torus",radius:.25,radiusTubular:.015,segmentsTubular:32},material:{color:"#0077CA",shader:"flat",opacity:.6,transparent:!0},text:{value:"i",height:5,side:"double",wrapCount:4,align:"center",color:"#0077CA"},animation:{property:"rotation",easing:"easeInOutSine",dur:2e3,from:"0 0 0",to:"0 360 0",loop:!0}}},register:function(){(0,n.registerPrimitive)("hot-spot",n.utils.extendDeep(n.primitives.getMeshMixin(),this.config))}};exports.default=i},546:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i="text-panel",o={config:{defaultComponents:{geometry:{primitive:"plane",height:"auto",width:2},material:{color:"#000000",opacity:.6,transparent:!0},text:{value:"Insert text here\nSecond line\nThird, somewhat longer line",align:"center",wrapCount:25}},mappings:{content:"text.value",height:"geometry.height"}},register:function(){(0,n.registerPrimitive)(i,n.utils.extendDeep(n.primitives.getMeshMixin(),this.config))}};exports.default=o},547:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i="hover-animation",o="mouseenter,focus",a="mouseleave,blur",s="linear",r=600,l=600,c={config:{schema:{scaleFactor:{default:1.1},opacityFactor:{default:.9},fillColor:{type:"color",default:!1},textColor:{type:"color",default:!1}},init:function(){this.defaultScale={x:1,y:1,z:1},this.defaultOpacity=1,this.defaultColor="#FFF",this.el.getAttribute("tabindex")||this.el.setAttribute("tabindex",0),this.setOpacityAnimation(),this.setScaleAnimation(),this.data.fillColor&&this.setFillColorAnimation(),this.data.textColor&&this.setTextColorAnimation()},setAnimation:function(t){var e=t.property,n=t.from,i=t.to,c=t.dur,u=void 0===c?l:c,d=t.easing,m=void 0===d?s:d,f=t.elasticity,p=void 0===f?r:f,h=t.startEvents,g=void 0===h?o:h,v=t.pauseEvents,b=void 0===v?a:v;this.el.setAttribute("animation__"+e+"-enter",{property:e,from:n,to:i,dur:u,easing:m,elasticity:p,startEvents:g,pauseEvents:b}),this.el.setAttribute("animation__"+e+"-leave",{property:e,from:i,to:n,dur:u,easing:m,elasticity:p,startEvents:b,pauseEvents:g})},setScaleAnimation:function(){var t=this.el.getAttribute("scale")||this.defaultScale,e={x:t.x*this.data.scaleFactor,y:t.y*this.data.scaleFactor,z:t.z*this.data.scaleFactor};this.setAnimation({property:"scale",from:t,to:e,easing:"easeOutElastic"})},setOpacityAnimation:function(){var t=this.el.getAttribute("material").opacity||this.defaultOpacity,e=t*this.data.opacityFactor;this.setAnimation({property:"opacity",from:t,to:e})},setFillColorAnimation:function(){var t=this.el.getAttribute("material").color||this.defaultColor;this.setAnimation({property:"color",from:t,to:this.data.fillColor,dur:l/2})},setTextColorAnimation:function(){var t=this.el.components.text.data.color||this.defaultColor;this.setAnimation({property:"text.color",from:t,to:this.data.textColor,dur:l/2})}},register:function(){(0,n.registerComponent)(i,this.config)}};exports.default=c},548:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i={config:{schema:{type:"selector"},init:function(){var t=this.data.getAttribute("scale"),e=this.el.getAttribute("scale"),n={x:e.x/t.x,y:e.y/t.y,z:e.z/t.z};this.el.setAttribute("scale",n)}},register:function(){(0,n.registerComponent)("level-scale-to",this.config)}};exports.default=i},549:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i="hit-box",o=["mouseenter","focus","mouseleave","blur","click"],a={config:{defaultComponents:{geometry:{primitive:"box"},material:{shader:"flat",flatShading:!0,wireframe:!0,opacity:0,transparent:!0},"delegate-event":{events:o,elements:[]}},mappings:{hit:"delegate-event.elements"}},register:function(){(0,n.registerPrimitive)(i,n.utils.extendDeep(n.primitives.getMeshMixin(),this.config))}};exports.default=a},550:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(551),o=n(i),a=e(418),s=n(a),r=e(434),l={config:{schema:{elements:{type:"selectorAll"},events:{type:"array"}},init:function(){this.validateProperties(),this.unbinders={},this.bindAllEventsToElements()},update:function(t){var e=this;0!==(0,s.default)(t).length&&(this.validateProperties(),this.oldData.elements.forEach(function(t){var n=e.data.elements.indexOf(t);n===-1&&e.unbindAllEventsFromElement(t)}),this.oldData.events.forEach(function(t){var n=e.data.events.indexOf(t);n===-1&&(e.unbinders[t].forEach(function(t){return t()}),e.unbinders.delete(t))}))},bindAllEventsToElements:function(){var t=this;this.data.elements.forEach(function(e){return t.bindAllEventsTo(e)})},bindAllEventsTo:function(t){var e=this;this.data.events.forEach(function(n){return e.bindEventTo(n,t)})},bindEventTo:function(t,e){var n=this,i=this.delegateEvent.bind(e);this.el.addEventListener(t,i);var a=function(){return n.el.removeEventListener(t,i)};this.unbinders[t]=new o.default,this.unbinders[t].set(e,a)},delegateEvent:function(t){this.emit(t.type,{originalEv:t},!1)},unbindAllEventsFromElement:function(t){var e=this;(0,s.default)(this.unbinders).forEach(function(n){if(e.unbinders[n].has(t)){var i=e.unbinders[n].get(t);i(),e.unbinders[n].delete(t)}})},validateProperties:function(){if(!this.data.elements)throw new Error("delegateEvent: Please provide an element selector to delegate events to!");if(!this.data.events||!this.data.events.length)throw new Error("delegateEvent: Please provide at least one event to delegate!")}},register:function(){(0,r.registerComponent)("delegate-event",this.config)}};exports.default=l},571:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=e(434),i=AFRAME.utils.debug("components:anchor-look:warn"),o={config:{dependencies:["camera"],init:function(){this.camera=this.el.components.camera.camera,this.targetAnchor=null},tick:function(t){var e=this.getUpdatedHash();if(e){var n=this.target3DFromHash(e);if(n){this.targetAnchor=e;var i=this.el.object3D.worldToLocal(n.getWorldPosition());console.log(this),this.camera.lookAt(i),this.camera.updateProjectionMatrix()}}},getUpdatedHash:function(){return window.location.hash!==this.targetAnchor&&window.location.hash},target3DFromHash:function(t){var e=this.el.sceneEl.querySelector(t);return e?e.object3D:void i('The anchor "'+t+'" does not point to a valid entity!')}},register:function(){(0,n.registerComponent)("anchor-look",this.config)}};exports.default=o},572:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(573),s=n(a),r=e(611),l=n(r),c=e(618),u=n(c),d=e(625),m=n(d),f=e(637),p=n(f),h=o.default.module("app.components",[s.default,l.default,u.default,m.default,p.default]).name;exports.default=h},573:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(574),s=n(a),r=e(581),l=n(r),c=e(585),u=n(c),d=e(593),m=n(d),f=o.default.module("aframe",[s.default,l.default,u.default,m.default]).name;exports.default=f},574:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(575),s=n(a),r=e(580),l=n(r),c=o.default.module("aframe.scene",[]).component("aframeScene",s.default).service("$aframeScene",l.default).name;exports.default=c},575:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(576),o=n(i),a=e(577),s=n(a);e(578);var r={controller:s.default,template:o.default,bindings:{sky:"@",sceneLinks:"<?",hotSpots:"<?",entities:"<?",mobile:"<?"},transclude:{editor:"?sceneEditor"}};exports.default=r},576:function(t,exports){t.exports='<ng-transclude ng-transclude-slot="editor"></ng-transclude>\n\n<a-scene id="aframe-scene" ng-transclude-slot="sky"> <!-- stats -->\n\t\n\t<!-- ASSET CACHE -->\n\t<a-assets>\n\t\t<a-mixin id="mixin-blue" material="color: #0077CA;opacity: 0.85; transparent: true;"></a-mixin>\n\t\t<a-mixin id="mixin-glow" material="color:white;shader:flat;opacity:0.1;transparent: true;"></a-mixin>\n\t\t<img src="assets/images/plnsk_bg_default.jpg" id="default_sky_bg" />\n\t</a-assets>\n\n\t<!-- SKY -->\n\t<aframe-sky sky="$ctrl.sky"></aframe-sky>\n\t<a-sky src="#default_sky_bg" ng-if="!$ctrl.sky" animation__sky-rotate="property: rotation; dur: 90000; easing: linear; to: 0 360 0; loop: true;"></a-sky>\n\n\t<!-- LIGHT -->\n\t<a-light type="ambient" color="#BBB""></a-light>\n\t<a-light type="directional" color="#FFF" intensity="0.6" position="-0.5 1 1"></a-light>\n\n\t<!-- CAMERA ENTITY -->\n\t<a-camera\n\t\tid="aframe-camera"\n\t\tmouse-cursor\n\t\tanchor-look\n\t\twasd-controls="enabled: false;"\n\t\tlook-controls="reverseMouseDrag: true;">\n\t\t<!-- VR CURSOR -->\n\t  <a-entity ng-if="$ctrl.mobile.device && $ctrl.mobile.landscape"\n\t  \t\t\t\t\tcursor="fuse: true; fuseTimeout: 2000"\n\t            position="0 0 -1"\n\t            geometry="primitive: ring; radiusInner: 0.007; radiusOuter: 0.01; thetaLength: 360;"\n\t            material="color: white; opacity: 0.8; shader: flat"\n\t            animation__cursor-mouseenter-outer="property: geometry.radiusOuter; dur: 600; easing: easeOutBounce; elasticity: 500; to: 0.025; startEvents: mouseenter;"\n\t            animation__cursor-mouseenter-inner="property: geometry.radiusInner; dur: 600; easing: easeOutBounce; elasticity: 500; to: 0.02; startEvents: mouseenter;"\n\t            animation__cursor-mouseleave-outer="property: geometry.radiusOuter; dur: 600; to: 0.01; startEvents: mouseleave;"\n\t            animation__cursor-mouseleave-inner="property: geometry.radiusInner; dur: 600; to: 0.007; startEvents: mouseleave;">\n\t\t\t<a-animation attribute="geometry.thetaLength"\n\t\t\t\t\t\t\t\t\t begin="cursor-fusing"\n\t\t\t\t\t\t\t\t\t dur="1600"\n\t\t\t\t\t\t\t\t\t delay="400"\n\t\t\t\t\t\t\t\t\t easing="ease-in"\n\t\t\t\t\t\t\t\t\t fill="both"\n\t\t\t\t\t\t\t\t\t from="360"\n\t\t\t\t\t\t\t\t\t to="0">\n\t\t\t</a-animation>\n\t\t\t<a-animation attribute="geometry.thetaLength"\n\t\t\t\t\t\t\t\t\t begin="mouseleave"\n\t\t\t\t\t\t\t\t\t dur="600"\n\t\t\t\t\t\t\t\t\t to="360">\n\t\t\t</a-animation>\n\t  </a-entity>\n\t</a-camera>\n\t\n\t<!-- GENERIC ENTITIES -->\n\t<aframe-entity ng-model="entity" ng-repeat="entity in $ctrl.entities track by entity._id"></aframe-entity>\n\n\t<!-- SCENE LINKS -->\n\t<hit-box ng-repeat="sceneLink in $ctrl.sceneLinks track by sceneLink._id"\n\t\t\t\t\t ng-attr-position="{{ sceneLink.position.join(\' \') }}"\n\t\t\t\t\t ng-attr-rotation="{{ sceneLink.rotation.join(\' \') }}"\n\t\t\t\t\t ng-attr-hit="#link_{{ ::sceneLink._id }}, #link_{{ ::sceneLink._id }} .text-panel"\n\t\t\t\t\t ui-sref="scene({ location: sceneLink.scene.parent.parent.code, building: sceneLink.scene.parent.code, scene: sceneLink.scene.code })"\n\t\t\t\t\t editable="sceneLink">\n\t\t<scene-link ng-attr-id="link_{{ ::sceneLink._id }}"\n\t\t\t\t\t\t\t\thover-animation="scaleFactor:1.1;fillColor:#c71566;opacityFactor:0.7;"\n\t\t\t\t\t\t\t\tcolor="#0077CA">\n\t\t\t<a-animation attribute="scale"\n\t\t\t\t\t\t\t\t\t begin="click"\n\t\t\t\t\t\t\t\t\t dur="600"\n\t\t\t\t\t\t\t\t\t easing="ease-out"\n\t\t\t\t\t\t\t\t\t fill="backwards"\n\t\t\t\t\t\t\t\t\t to="0 0 0">\n\t\t\t</a-animation>\n\t\t\t<text-panel ng-if="sceneLink.scene.parent._id !== $ctrl.parent._id"\n\t\t\t\t\t\t\t\t\tcontent="GO TO:\\n\\n{{sceneLink.scene.parent.name}}"\n\t\t\t\t\t\t\t\t\trotation="90 90 0"\n\t\t\t\t\t\t\t\t\tposition="5.25 0 0"\n\t\t\t\t\t\t\t\t\tscale="0.001 0.01 0.001"\n\t\t\t\t\t\t\t\t\theight="0.75"\n\t\t\t\t\t\t\t\t\thover-animation="scaleFactor:1000;fillColor:#000000;opacityFactor:1;"\n\t\t\t\t\t\t\t\t\tclass="text-panel">\n\t\t\t</text-panel>\n\t\t</scene-link>\n\t</hit-box>\n\n\t<!-- HOTSPOTS -->\n\t<hit-box ng-repeat="hotSpot in $ctrl.hotSpots track by hotSpot._id"\n\t\t\t\t\t\tng-attr-position="{{ hotSpot.position.join(\' \') }}"\n\t\t\t\t\t\tng-attr-id="hotSpot_{{ ::hotSpot._id }}"\n\t\t\t\t\t\tng-attr-hit="#hotSpot_{{ ::hotSpot._id }} .text-panel, #hotSpot_{{ ::hotSpot._id }} hot-spot"\n\t\t\t\t\t\tlook-at="[camera]"\n\t\t\t\t\t\teditable="hotSpot">\n\t\t<hot-spot hover-animation="scaleFactor:1.1;fillColor:#c71566;textColor:#c71566;opacityFactor:0.7;"></hot-spot>\n    <text-panel content="{{ [\'More about \', (hotSpot.feature.properties.name || hotSpot.name).toUpperCase(), \'\\n\\n\', (hotSpot.feature.properties.desc || hotSpot.desc)].join(\'\') }}"\n\t\t\t\t\t\t\t\tanimation="property: scale; from: 0 0 0; to: 1 1 1; dur: 600; easing: easeOutElastic; elasticity: 600; startEvents: click"\n\t\t\t\t\t\t\t\tscale="0.001 0.001 0.001"\n\t\t\t\t\t\t\t\tposition="0 0 1"\n\t\t\t\t\t\t\t\trotation="0 0 0"\n\t\t\t\t\t\t\t\tclass="text-panel">\n\t\t</text-panel>\n\t</hit-box>\n\n</a-scene>\n<!-- <div class="test-links">\n\t<a ng-href="#hotSpot_{{ ::hotSpot._id }}" ng-repeat="hotSpot in $ctrl.hotSpots track by hotSpot._id">{{ ::(hotSpot.feature.properties.name || hotSpot.name) }}</a>\n</div> -->'},577:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=e(299),l=function(){function t(e,n,i,a){"ngInject";(0,o.default)(this,t),this.$scope=e,this.$element=n,this.$aframeScene=i,this.$aframeSky=a}return t.$inject=["$scope","$element","$aframeScene","$aframeSky"],(0,s.default)(t,[{key:"$onInit",value:function(){this._rightClick=!1,this._isMobile=!1,this._currentSceneId="",this.$sceneEl=this.$element.find("a-scene"),this.$assetsEl=this.$sceneEl.find("a-assets"),this.$cameraEl=(0,r.element)(document.getElementById("aframe-camera"))}},{key:"$onChanges",value:function(t){console.log(t),t.mobile.isFirstChange()||(!this._isMobile&&t.mobile.currentValue.screen&&(this._isMobile=!0),this._isMobile&&!t.mobile.currentValue.screen&&(this._isMobile=!1))}},{key:"setScene",value:function(t){var e=t.sceneLinks,n=t.hotSpots,i=t.entities,o=t.parent,a=t._id;this.sceneLinks=e,this.hotSpots=n,this.entities=i,this.parent=o,this._currentSceneId=a,this.checkForDraft&&this.checkForDraft()}},{key:"$doCheck",value:function(){(0,r.isDefined)(this.$aframeScene.scene)&&(this.$aframeScene.scene._id&&this.$aframeScene.scene._id!==this._currentSceneId&&this.setScene(this.$aframeScene.scene),this.$aframeSky.sky&&(this.sky&&this.$aframeSky.sky===this.sky||(this.sky=this.$aframeSky.sky,console.log("scene controller detects change in sky service",this.sky))))}}]),t}();exports.default=l},578:function(t,exports){},580:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(418),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=e(299),u=function(){function t(e,n,i){"ngInject";var a=this;(0,s.default)(this,t),this.$mdToast=e,this.$aframeSky=n,this.toasts={},(0,o.default)(i).forEach(function(t){var n=e.simple(),s=i[t];(0,o.default)(s).forEach(function(t){n[t](s[t])}),a.toasts[t]=n})}return t.$inject=["$mdToast","$aframeSky","EDITOR_MESSAGES"],(0,l.default)(t,[{key:"removeItemFrom",value:function(t,e,n){var i=this;this.$mdToast.show(this.toasts.confirm).then(function(o){if("ok"==o){var a=e.indexOf(t);if(a!==-1)return e.splice(a,1),n&&n(),i.$mdToast.show(i.toasts.itemRemoved)}}).then(function(t){"ok"==t&&i.$aframeEditor.publish()})}},{key:"addItemTo",value:function(t,e,n){var i=this;(0,c.isObject)(t)&&(0,c.isArray)(e)&&(e.push(t),n&&n(e),t.position&&t.position.length&&this.toasts.itemAdded.textContent("Item added at "+t.position.join(", ")+"!"),this.$mdToast.show(this.toasts.itemAdded).then(function(t){"ok"==t&&i.$aframeEditor.publish()}))}},{key:"scene",get:function(){if(this.sceneData)return this.sceneData},set:function(t){this.$aframeSky.sky=t.panorama,this.sceneData=this.lastPublished=t}}]),t}();exports.default=u},581:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(582),s=n(a),r=e(584),l=n(r),c=o.default.module("aframe.sky",[]).component("aframeSky",s.default).service("$aframeSky",l.default).name;exports.default=c},582:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(583),o=n(i),a={controller:o.default,bindings:{sky:"<",preload:"<?"},require:{SceneCtrl:"^aframeScene"}};exports.default=a;
},583:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n,i){"ngInject";(0,o.default)(this,t),this.compileSkyEl=function(t){return n("<a-sky ng-src=\"{{ '#' + $ctrl.loadedSky }}\" />")(e,t)},this.$aframeSky=i}return t.$inject=["$scope","$compile","$aframeSky"],(0,s.default)(t,[{key:"$onInit",value:function(){this.$sceneEl=this.SceneCtrl.$sceneEl,this.$assetsEl=this.SceneCtrl.$assetsEl,this._skyElLoaded=!1,this._skyLoadedList=[]}},{key:"$onChanges",value:function(t){if(!t.sky.isFirstChange()){var e=t.sky.currentValue;e&&this.setSky(e,this.assetIdFromSkyUrl(e))}}},{key:"assetIdFromSkyUrl",value:function(t){return t.split("scenes/panorama/")[1].split(".")[0]}},{key:"preload",value:function(){var t=this;this.$aframeSky.getPreloadList(this.SceneCtrl._currentSceneId).then(function(e){e.forEach(function(e){var n=t.assetIdFromSkyUrl(e);t._skyLoadedList.includes(n)||t.loadSkyAsset(e,n)})}).catch(function(t){console.warn(t)})}},{key:"setSkyId",value:function(t){this.loadedSky=t,this.preload()}},{key:"setSky",value:function(t,e){var n=this;return this._skyLoadedList.includes(e)?this.setSkyId(e):this.loadSkyAsset(t,e).then(function(t){n._skyElLoaded||(n.$skyEl=n.loadSkyEl()),n.setSkyId(t)})}},{key:"loadSkyAsset",value:function(t,e){var n=this;return this.$aframeSky.getSkyDomNode(t,e).then(function(i){return n.$assetsEl.append(i),n._skyLoadedList.push(e),console.log("sky asset preloaded: ",t),e})}},{key:"loadSkyEl",value:function(){var t=this;return this.compileSkyEl(function(e){return t.$sceneEl.append(e),t._skyElLoaded=!0,e})}}]),t}();exports.default=r},584:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(418),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=e(434),u=100,d=12,m=function(){function t(e,n,i,o){"ngInject";(0,s.default)(this,t),this.$q=e,this.Preload=n.preload,this.UserSession=i,this.imageApiUrl=o.imageApiUrl}return t.$inject=["$q","$tourApi","UserSession","GLOBAL_SETTINGS"],(0,l.default)(t,[{key:"getSettings",value:function(){var t=c.utils.device.isMobile(),e=!this.UserSession.usage.resolution.val,n={w:t||e?2048:4096,h:t||e?1024:2048,c:"scale",f:"auto",q:u-d*this.UserSession.usage.compression.val};return(0,o.default)(n).map(function(t){return t+"_"+n[t]}).join(",")}},{key:"getPreloadList",value:function(t){var e=this;return this.$q(function(n,i){switch(e.UserSession.usage.preloading.val){case 0:n([]);break;case 1:case 2:e.Preload.get({id:t}).$promise.then(function(t){return n(t)});break;default:i("Can't determine preload settings")}})}},{key:"getSkyDomNode",value:function(t,e){var n=this;return this.$q(function(i,o){var a=angular.element('<img src="'+n.imageApiUrl+"/"+n.getSettings()+"/v"+t+'" id="'+e+'" crossOrigin="anonymous" />');a.on("load",function(){return i(a)}),a.on("error",function(){return o("Image load error")})})}},{key:"sky",get:function(){return this.panorama?[this.panorama.version,this.panorama.public_id].join("/"):null},set:function(t){console.log("sky service set to:",t),this.panorama=t}}]),t}();exports.default=m},585:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(586),s=n(a),r=e(590),l=(n(r),o.default.module("aframe.entity",[]).component("aframeEntity",s.default).component("entityControls",s.default).name);exports.default=l},586:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(587),o=n(i),a={controller:o.default,require:{$ngModel:"ngModel",SceneCtrl:"^aframeScene"}};exports.default=a},587:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(588),o=n(i),a=e(378),s=n(a),r=e(323),l=n(r),c=e(324),u=n(c),d=function(){function t(e,n,i){"ngInject";(0,l.default)(this,t),this._$scope=e,this._$element=n,this._$compile=i,this.entityEl=!1}return t.$inject=["$scope","$element","$compile"],(0,u.default)(t,[{key:"$onInit",value:function(){var t=this;this._$scope.$watch(function(){return t.$ngModel.$modelValue.type},function(e,n){e&&t.$ngModel.$valid&&(console.info("entity type $watch",e),t.entityEl=t.compileTemplate(e),console.log(t.entityEl),t.entityEl.attr(t.parseAttrs(t.$ngModel.$modelValue.attrs)),t.entityEl.on("click",function(){t.SceneCtrl._rightClick&&t.SceneCtrl._editable&&t.SceneCtrl.editItem(t.SceneCtrl._rightClick,t.$ngModel.$modelValue,t.SceneCtrl.entities)}))}),this._$scope.$watch(function(){return t.$ngModel.$modelValue.attrs},function(e){t.entityEl&&e&&angular.isArray(e)&&t.$ngModel.$valid&&(console.info("entity attrs $watch",e),t.entityEl.attr(t.parseAttrs(e)))},!0),this._$scope.$parent.$on("$destroy",function(){t.entityEl.remove(),t._$scope.$destroy()})}},{key:"compileTemplate",value:function(t){var e=this;return this._$compile("<a-"+t+"></a-"+t+">")(this,function(t,n){return e._$element.after(t),e._$element.remove(),console.info("entity recompiled",t),t})}},{key:"parseAttrs",value:function(t){var e={},n=!0,i=!1,a=void 0;try{for(var r,l=function(){var t=r.value,n=t.prop,i=t.val;n&&(i=JSON.parse((0,o.default)(i)),angular.isArray(i)&&(i=i.map(function(t,e){return i[e]}).join(" ")),angular.isObject(i)&&!function(){var t=[];angular.forEach(i,function(e,n){t.push([n,e].join(": "))}),i=t.join("; ")}(),e[n]=i,console.info("attr added:%c "+n+" = "+i,"color: blue;"))},c=(0,s.default)(t);!(n=(r=c.next()).done);n=!0)l()}catch(t){i=!0,a=t}finally{try{!n&&c.return&&c.return()}finally{if(i)throw a}}return e}}]),t}();exports.default=d},590:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(591),o=n(i),a=e(592),s=n(a),r={template:o.default,controller:s.default,require:{$ngModel:"ngModel"}};exports.default=r},591:function(t,exports){t.exports='<div class="md-title">\n  Element:\n</div>\n<md-input-container>\n  <label>\n    Type:\n  </label>\n    <input ng-model="type" />\n</md-input-container>\n<div class="md-title">\n  Attributes:\n</div>\n<md-list layout="column">\n  <md-list-item layout layout-wrap ng-repeat="attr in attrs">\n    <span class="md-subheader" flex="100">\n      <strong>{{attr.prop}}="<em>{{attr.val}}</em></strong>"\n    </span><br/>\n    <md-input-container>\n      <label>\n        Property\n      </label>\n      <input ng-model="attr.prop" />\n    </md-input-container>\n    <md-input-container>\n      <label>\n        Value\n      </label>\n      <input ng-model="attr.val" />\n    </md-input-container>\n    <md-button class="md-raised md-warn" ng-click="$ctrl.removeAttr(attr)">Remove</md-button>\n  </md-list-item>\n  <md-list-item>\n    <md-button class="md-raised md-primary" ng-click="$ctrl.addAttr()">Add attribute</md-button>\n  </md-list-item>\n</md-list>'},592:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e){"ngInject";(0,o.default)(this,t),this._$scope=e}return t.$inject=["$scope"],(0,s.default)(t,[{key:"$onInit",value:function(){var t=this;this.$ngModel.$formatters.push(function(t){var e=t.type,n=t.attrs;return console.info("control $formatter",{type:e,attrs:n}),{type:e,attrs:n}}),this.$ngModel.$render=function(){var e=t.$ngModel.$viewValue,n=e.type,i=e.attrs;console.log("control $render",{type:n,attrs:i}),t._$scope.type=n,t._$scope.attrs=i},this._$scope.$watch(function(){return{attrs:t._$scope.attrs,type:t._$scope.type}},function(e){console.log("control $watch",e),t.$ngModel.$setViewValue({type:t._$scope.type,attrs:t._$scope.attrs})},!0),this.$ngModel.$parsers.push(function(t){var e=t.type,n=t.attrs;return console.log("control $parser",{type:e,attrs:n}),{type:e,attrs:n}})}},{key:"addAttr",value:function(){return console.log("attr added from control"),this._$scope.attrs.push({prop:"",val:""})}},{key:"removeAttr",value:function(t){var e=this;angular.forEach(this._$scope.attrs,function(n,i){if(n.$$hashKey===t.$$hashKey)return console.log("attr removed from control",n),e._$scope.attrs.splice(i,1)})}}]),t}();exports.default=r},593:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(310),s=n(a),r=e(594),l=n(r),c=e(595),u=n(c),d=e(606),m=n(d),f=e(609),p=n(f),h=e(610),g=n(h),v=o.default.module("aframe.editor",[s.default]).directive("editable",l.default).component("sceneEditor",u.default).service("$aframeEditor",m.default).config(["$mdPanelProvider",function(t){"ngInject";t.definePreset("editorDialog",{template:p.default,controller:g.default,attachTo:o.default.element(document.body),controllerAs:"$ctrl",bindToController:!0,panelClass:"editor-dialog",clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!0,zIndex:85})}]).constant("EDITOR_MESSAGES",{confirm:{textContent:"Are you sure?",action:"Confirm",highlightAction:!0,highlightClass:"md-warn",position:"bottom left",hideDelay:0},itemRemoved:{textContent:"Item removed!",action:"Publish changes",highlightAction:!0,highlightClass:"md-primary",position:"bottom left",hideDelay:5e3},itemAdded:{textContent:"Item added!",action:"Publish changes",highlightAction:!0,highlightClass:"md-primary",position:"bottom left",hideDelay:5e3},draftLoaded:{textContent:"Draft loaded!",action:"Publish changes",highlightAction:!0,highlightClass:"md-primary",position:"bottom left",hideDelay:5e3},saveDraft:{textContent:"Draft saved!",action:"Publish changes",highlightAction:!0,highlightClass:"md-primary",position:"bottom left",hideDelay:5e3},draftFound:{textContent:"Saved drafts found!",action:"Load most recent",highlightAction:!0,highlightClass:"md-primary",position:"bottom left",hideDelay:5e3},publish:{textContent:"Changes published!",action:"Dismiss",position:"bottom left",hideDelay:5e3},discardDraft:{textContent:"Draft discarded!",action:"Dismiss",position:"bottom left",hideDelay:1e3},revertToDraft:{textContent:"Reverted to last draft!",action:"Dismiss",position:"bottom left",hideDelay:2e3}}).constant("DATA_MODELS",{scene:{name:"",code:"",parent:"",panorama:""},sceneLinks:{scene:"",position:[0,0,0],rotation:[0,0,70]},hotSpots:{linked:!1,name:"",desc:"",feature:"",position:[0,0,0]}}).name;exports.default=v},594:function(t,exports){"use strict";function e(t){"ngInject";return{restrict:"A",scope:{editable:"@"},require:"^aframeScene",link:function(e,n,i,o){var a=function(n){console.log(e.$parent),o._rightClick&&o._editable&&(n.preventDefault(),o.editItem(o._rightClick,e.$parent[e.editable],o[e.editable+"s"]),t.eventTrack("click",{category:"edit:scene",label:e.$parent[e.editable]._id}))};n.on("click",a)}}}e.$inject=["$analytics"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},595:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(596),o=n(i),a=e(597),s=n(a);e(604);var r={template:o.default,controller:s.default,require:{SceneCtrl:"^aframeScene"}};exports.default=r},596:function(t,exports){t.exports='<md-fab-toolbar md-open="demo.isOpen" count="demo.count" md-direction="left">\n  <md-fab-trigger class="align-with-text">\n    <md-button aria-label="Open scene editor menu" class="md-fab md-primary">\n\t\t  <md-tooltip md-direction="left" md-autohide ng-if="!$root.appSettings.settings.showHints.val">\n\t\t    Open scene editor menu\n\t\t  </md-tooltip>\n      <ng-md-icon icon="edit"></ng-md-icon>\n    </md-button>\n  </md-fab-trigger>\n\n  <md-toolbar>\n    <md-fab-actions class="md-toolbar-tools" ng-mouseleave="$ctrl.tooltipMsg = false">\n      <md-button aria-label="New scene" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'New scene\'" ng-click="$ctrl.newScene($event)">\n        <ng-md-icon icon="insert_drive_file"></ng-md-icon>\n      </md-button>\n      <span class="fab-divider"></span>\n      <md-button aria-label="New scene link" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'New scene link\'" ng-click="$ctrl.addItem($event, \'sceneLinks\')">\n        <ng-md-icon icon="add_location"></ng-md-icon>\n      </md-button>\n      <md-button aria-label="photo" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'New hotspot\'" ng-click="$ctrl.addItem($event, \'hotSpots\')">\n        <ng-md-icon icon="info_outline"></ng-md-icon>\n      </md-button>\n      <span class="fab-divider"></span>\n      <md-button aria-label="Save draft" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'Save draft\'" ng-click="$ctrl.saveDraft()">\n        <ng-md-icon icon="save"></ng-md-icon>\n      </md-button>\n\n      <md-menu md-offset="0 -7">\n        <md-button aria-label="Load draft" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'Load draft\'" ng-click="$ctrl.checkForDraft(false);$mdOpenMenu($event)">\n\t        <ng-md-icon icon="folder_open"></ng-md-icon>\n\t      </md-button>\n        <md-menu-content width="6" ng-switch="$ctrl.draftList.length">\n          <md-menu-item ng-repeat="draft in $ctrl.draftList">\n            <md-button ng-click="$ctrl.loadDraft(draft)" ng-attr-id="draft_{{ ::draft.updatedAt }}">{{ draft.updatedAt | date:\'medium\' }}</md-button>\n            <md-button ng-click="$ctrl.discardDraft(draft)" class="md-icon-button md-raised md-warn" aria-label="Discard this draft" aria-labelledby="draft_{{ ::draft.updatedAt }}">\n\t\t\t        <ng-md-icon icon="delete" size="22"></ng-md-icon>\n\t\t\t      </md-button>\n          </md-menu-item>\n          <md-menu-item ng-hide="$ctrl.draftList.length">\n          \t<span>No drafts available</span>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n\n      <md-button aria-label="Publish changes" class="md-icon-button" ng-mouseenter="$ctrl.tooltipMsg = \'Publish changes\'" ng-click="$ctrl.publish()">\n        <ng-md-icon icon="publish"></ng-md-icon>\n      </md-button>\n      <md-button ng-show="$ctrl.tooltipMsg">{{ $ctrl.tooltipMsg }}</md-button>\n    </md-fab-actions>\n  </md-toolbar>\n</md-fab-toolbar>'},597:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(598),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=function(){function t(e,n,i,o,a,r){"ngInject";(0,s.default)(this,t),this.$timeout=e,this.$mdPanel=n,this.$mdDialog=i,this.$aframeScene=o,this.$aframeEditor=a,this._unpublishedChanges=!1,this._schemas=r}return t.$inject=["$timeout","$mdPanel","$mdDialog","$aframeScene","$aframeEditor","DATA_MODELS"],(0,l.default)(t,[{key:"updateSceneData",value:function(t){(0,o.default)(this.SceneCtrl,t),this.$aframeScene.scene=t,console.info("updated scene with data from editor:",t)}},{key:"saveDraft",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$aframeEditor.saveDraft(t)}},{key:"loadDraft",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$aframeEditor.loadDraft(t._id,n).then(function(t){return e.updateSceneData(t)})}},{key:"checkForDraft",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.draftList=null,this.$aframeEditor.checkForDraft(e).then(function(n){return t.draftList=n,n.length&&e&&t.$aframeEditor.draftFound(n)}).then(function(e){return e&&t.updateSceneData(e)})}},{key:"discardDraft",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.$mdDialog.confirm().title("Are you sure?").textContent("This action cannot be undone.").ok("Confirm").cancel("Cancel");this.$mdDialog.show(i).then(function(){e.$aframeEditor.discardDraft(t._id,n)})}},{key:"publish",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.$aframeEditor.publish(t,n).then(function(t){return e.updateSceneData(t)})}},{key:"$onInit",value:function(){var t=this,e=function(e){e.stopPropagation(),t.SceneCtrl._rightClick||(t.SceneCtrl._rightClick=e,e.preventDefault(),t.SceneCtrl.$sceneEl.on("mouseup",function(){t.SceneCtrl.$sceneEl.off("mouseup"),t.$timeout(function(){t.SceneCtrl._rightClick=!1})}))};this.SceneCtrl.$sceneEl.on("contextmenu",e),this.SceneCtrl.$onDestroy=function(){t.$sceneEl.off("contextmenu",e)},this.SceneCtrl.checkForDraft=function(){return t.checkForDraft()},this.SceneCtrl.editItem=function(e,n,i){return t.editItem(e,n,i)},this.SceneCtrl._editable=!0}},{key:"addItem",value:function(t,e){var n=this,i={item:this._schemas[e]};return i.newItem=!0,i.publish=function(){return n.$aframeScene.addItemTo(i.item,n.SceneCtrl[e],function(t){n.$aframeScene.scene[e]=t,n._panelRef&&n._panelRef.close()})},i.saveDraft=function(){return n.$aframeScene.addItemTo(i.item,n.SceneCtrl[e],function(t){n.$aframeScene.scene[e]=t,n.saveDraft()})},i.removeThis=function(){return n._panelRef&&n._panelRef.close()},i.closeDialog=i.removeThis,this.openEditor(t,i)}},{key:"newScene",value:function(t){var e=this,n={item:this._schemas.scene};return n.newItem=!0,n.publish=function(){e.$aframeEditor.publish(n.item),e._panelRef&&e._panelRef.close()},n.saveDraft=function(){n.item.state="draft",n.publish()},n.removeThis=function(){return e._panelRef&&e._panelRef.close()},n.closeDialog=n.removeThis,this.openEditor(t,n)}},{key:"editItem",value:function(t,e,n){var i=this,o={item:e};return o.publish=function(){return i.publish()},o.saveDraft=function(){return i.saveDraft()},o.removeThis=function(){return i.$aframeScene.removeItemFrom(e,n,function(){i._panelRef&&i._panelRef.close()})},o.closeDialog=function(){return i._panelRef&&i._panelRef.close()},this.openEditor(t,o,{offsetY:-250})}},{key:"openEditor",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.offsetX,a=void 0===o?0:o,s=i.offsetY,r=void 0===s?0:s;console.log(t.clientY+r);var l=this.$mdPanel.newPanelPosition();e.newItem?l.absolute().center():l.absolute().bottom(0).left(0);var c=this.$mdPanel.newPanelAnimation().openFrom({top:t.clientY+r,left:t.clientX+a}).withAnimation(this.$mdPanel.animation.SCALE).closeTo({top:t.clientY+r,left:t.clientX+a}),u=function(){n._panelRef&&n._panelRef.destroy()};return this.$mdPanel.open("editorDialog",{position:l,animation:c,onDomRemoved:u,locals:e}).then(function(t){n._panelRef=t})}}]),t}();exports.default=c},604:function(t,exports){},606:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(418),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=e(607),u=function(){function t(e,n,i,a,r){"ngInject";var l=this;(0,s.default)(this,t),this.$mdToast=e,this.$aframeScene=n,this.DraftResource=a,this.SceneResource=i.scene,this.toasts={},(0,o.default)(r).forEach(function(t){var n=e.simple(),i=r[t];(0,o.default)(i).forEach(function(t){n[t](i[t])}),l.toasts[t]=n})}return t.$inject=["$mdToast","$aframeScene","$tourApi","DraftResource","EDITOR_MESSAGES"],(0,l.default)(t,[{key:"publish",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i="update",o=e||(0,c.pick)(this.$aframeScene.scene,["_id","code","name","assets","entities","hotSpots","sceneLinks","panorama","parent","script"]);return o.updatedAt=new Date,e&&(o.createdAt=o.updatedAt,i="save"),this.SceneResource[i](e?null:{id:o._id},o).$promise.then(function(e){return t.lastPublished=t.$aframeScene.scene||e,n&&t.$mdToast.show(t.toasts.publish),e})}},{key:"saveDraft",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.DraftResource.save({content:this.$aframeScene.scene,kind:"Scene",original:this.$aframeScene.scene._id}).$promise.then(function(n){return t.lastDraft=n.content,e&&t.$mdToast.show(t.toasts.saveDraft).then(function(e){"ok"==e&&t.publish()}),n})}},{key:"checkForDraft",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.$aframeScene.scene&&this.DraftResource.query({sort:"-updatedAt",filter:{original:this.$aframeScene.scene._id}}).$promise}},{key:"draftFound",value:function(t){var e=this;return this.$mdToast.show(this.toasts.draftFound).then(function(n){return"ok"===n&&e.loadDraft(t[0]._id)})}},{key:"loadDraft",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.DraftResource.get({id:t}).$promise.then(function(t){return e.lastDraft=t.content,n&&e.$mdToast.show(e.toasts.draftLoaded).then(function(t){return"ok"===t&&e.publish()}),t.content})}},{key:"revertToDraft",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.checkForDraft(!1).then(function(e){return t.loadDraft(e[0]._id,!1)}).then(function(n){return e&&t.$mdToast.show(t.toasts.revertToDraft)})}},{key:"discardDraft",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.DraftResource.remove({id:t}).$promise.then(function(t){return n&&e.$mdToast.show(e.toasts.discardDraft)})}}]),t}();exports.default=u},609:function(t,exports){t.exports='<div class="md-whiteframe-16dp" layout="column">\n\n  <div class="md-toolbar-tools">\n    <span class="md-title">{{ ::($ctrl.newItem ? \'New\' : \'Edit\') }} {{ ::($ctrl.item.hasOwnProperty(\'scene\') ? \'scene link\': \'\') }}{{ ::($ctrl.item.hasOwnProperty(\'parent\') ? \'scene\': \'\') }}{{ ::($ctrl.item.hasOwnProperty(\'content\') || $ctrl.item.hasOwnProperty(\'feature\') ? \'hotspot\' : \'\') }}{{ ::($ctrl.item.hasOwnProperty(\'attrs\') ? \'entity\' : \'\') }}</span>\n    <span flex></span>\n    <md-button class="md-icon-button md-primary" aria-label="Cancel" ng-click="$ctrl.closeDialog()">\n      <ng-md-icon icon="close" size="24"></ng-md-icon>\n    </md-button>\n  </div>\n\t<v-accordion class="vAccordion--default" multiple flex>\n\t  <!-- add expanded attribute to open the section -->\n\t  <v-pane ng-if="::($ctrl.item.hasOwnProperty(\'name\') || $ctrl.item.hasOwnProperty(\'label\') || $ctrl.item.hasOwnProperty(\'code\') || $ctrl.item.hasOwnProperty(\'desc\') || $ctrl.item.hasOwnProperty(\'feature\'))">\n\t    <v-pane-header>\n\t\t\t\tMetadata\n\t    </v-pane-header>\n\t    <v-pane-content>\n\t\t\t  <div layout="row" layout-padding ng-if="::$ctrl.item.hasOwnProperty(\'name\')">\n\t\t\t    <md-input-container flex style="margin-bottom:0;padding-bottom:0;">\n\t\t\t    \t<label>Name</label>\n\t\t\t      <input type="text" flex ng-model="$ctrl.item.name" aria-label="name">\n\t\t\t    </md-input-container>\n\t\t\t  </div>\n\t\t\t  <div layout="row" layout-padding ng-if="::$ctrl.item.hasOwnProperty(\'label\')">\n\t\t\t    <md-input-container flex style="margin-bottom:0;padding-bottom:0;">\n\t\t\t    \t<label>Label</label>\n\t\t\t      <input type="text" flex ng-model="$ctrl.item.label" aria-label="label">\n\t\t\t    </md-input-container>\n\t\t\t  </div>\n\t\t\t  <div layout="row" layout-padding ng-if="::$ctrl.item.hasOwnProperty(\'code\')">\n\t\t\t    <md-input-container flex style="margin-bottom:0;padding-bottom:0;">\n\t\t\t    \t<label>Code</label>\n\t\t\t      <input type="text" flex ng-model="$ctrl.item.code" aria-label="code">\n\t\t\t    </md-input-container>\n\t\t\t  </div>\n\t\t\t  <div layout="column" layout-padding ng-if="::($ctrl.item.hasOwnProperty(\'desc\') || $ctrl.item.hasOwnProperty(\'feature\'))">\n\t\t    \t<div><md-checkbox\n              ng-model="$ctrl.item.linked"\n              aria-label="Link to campus map feature"\n              class="md-primary">\n            Link to campus map feature?\t\n          </md-checkbox></div>\n\t\t\t\t\t<div ng-if="$ctrl.item.linked">\n\t\t\t\t    <md-select placeholder="Select category" ng-model="$ctrl.category" md-on-open="$ctrl.loadCategories()" ng-model-options="{trackBy: \'$value._id\'}" ng-change="$ctrl.onChangeCategory()">\n\t\t\t\t      <md-option ng-value="category" ng-repeat="category in $ctrl.categories track by category._id">{{::category.name}}</md-option>\n\t\t\t\t    </md-select>\n\t\t\t\t    <md-select placeholder="Select feature" ng-model="$ctrl.feature" md-on-open="$ctrl.loadFeatures()" ng-model-options="{trackBy: \'$value._id\'}" ng-change="$ctrl.onChangeFeature()">\n\t\t\t\t      <md-option ng-value="feature" ng-repeat="feature in $ctrl.features track by feature._id">{{::feature.properties.name}}</md-option>\n\t\t\t\t    </md-select>\n\t\t\t\t  </div>\n\t        <md-input-container ng-if="!$ctrl.item.linked">\n\t          <label>Content</label>\n\t          <!-- <textarea ng-model="$ctrl.item.desc" md-maxlength="250" rows="4" md-select-on-focus></textarea> -->\n\t          <ng-wig ng-model="$ctrl.item.desc"></ng-wig>\n\t        </md-input-container>\n        </div>\n\t    </v-pane-content>\n\t  </v-pane>\n\t  <v-pane ng-if="::$ctrl.item.position.length">\n\t    <v-pane-header>\n\t\t\t\tPosition\n\t    </v-pane-header>\n\t    <v-pane-content>\n\t\t\t  <div layout="row" layout-padding>\n\t\t\t    <md-input-container flex ng-repeat="val in ::[{label:\'x\',path:\'M21,9L17,5V8H10V10H17V13M7,11L3,15L7,19V16H14V14H7V11Z\'},{label:\'z\',path:\'M9,3L5,7H8V14H10V7H13M16,17V10H14V17H11L15,21L19,17H16Z\'},{label:\'y\',path:\'M14.83,13.41L13.42,14.82L16.55,17.95L14.5,20H20V14.5L17.96,16.54L14.83,13.41M14.5,4L16.54,6.04L4,18.59L5.41,20L17.96,7.46L20,9.5V4M10.59,9.17L5.41,4L4,5.41L9.17,10.58L10.59,9.17Z\'}] track by $index" style="margin-bottom:0;padding-bottom:0;margin-top:36px;">\n\t\t\t    \t<label layout layout-align="space-between center"><strong>{{ ::val.label }}</strong><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" ng-attr-d="{{ ::val.path }}" /></svg></label>\n\t\t\t      <input type="number" min="-15" max="15" step="0.05" flex ng-model="$ctrl.item.position[$index]" to-number aria-label="position" aria-controls="scenelink-position">\n\t\t\t    </md-input-container>\n\t\t\t  </div>\n\t    </v-pane-content>\n\t  </v-pane>\n\n\t  <v-pane ng-if="::$ctrl.item.rotation.length">\n\t    <v-pane-header>\n\t\t\t\tRotation\n\t    </v-pane-header>\n\t    <v-pane-content>\n\t\t\t  <div layout="row" layout-padding>\n\t\t\t    <md-input-container flex ng-repeat="val in ::[{label:\'roll\',path:\'M17,17H7V14L3,18L7,22V19H19V13H17M7,7H17V10L21,6L17,2V5H5V11H7V7Z\'},{label:\'yaw\',path:\'M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z\'},{label:\'pitch\',path:\'M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z\'}] track by $index" style="margin-bottom:0;padding-bottom:0;margin-top:36px;">\n\t\t\t    \t<label layout layout-align="space-between center"><strong>{{ ::val.label }}</strong><svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#000000" ng-attr-d="{{ ::val.path }}" /></svg></label>\n\t\t\t      <input type="number" min="-180" max="180" step="5" flex ng-model="$ctrl.item.rotation[$index]" to-number aria-label="rotation" aria-controls="scenelink-rotation">\n\t\t\t    </md-input-container>\n\t\t\t  </div>\n\t    </v-pane-content>\n\t  </v-pane>\n\n\t  <v-pane ng-if="::($ctrl.item.hasOwnProperty(\'scene\') || $ctrl.item.hasOwnProperty(\'parent\') || $ctrl.item.hasOwnProperty(\'building\'))">\n\t    <v-pane-header>\n\t\t\t\tLink\n\t    </v-pane-header>\n\t    <v-pane-content>\n\t\t\t  <div layout="row" layout-padding>\n\t\t\t    <md-select placeholder="Select location" ng-model="$ctrl.location" md-on-open="$ctrl.loadLocations()" ng-model-options="{trackBy: \'$value._id\'}" ng-change="$ctrl.onChangeLocation()">\n\t\t\t      <md-option ng-value="location" ng-repeat="location in $ctrl.locations track by location._id">{{::location.label}}</md-option>\n\t\t\t    </md-select>\n\t\t\t    <md-select placeholder="Select building" ng-model="$ctrl.building" md-on-open="$ctrl.loadBuildings()" ng-model-options="{trackBy: \'$value._id\'}" ng-change="$ctrl.onChangeBuilding()">\n\t\t\t      <md-option ng-value="building" ng-repeat="building in $ctrl.buildings track by building._id">{{::building.label}}</md-option>\n\t\t\t    </md-select>\n\t\t\t    <md-select ng-if="$ctrl.item.hasOwnProperty(\'scene\')" placeholder="Select scene" ng-model="$ctrl.scene" md-on-open="$ctrl.loadScenes()" ng-model-options="{trackBy: \'$value._id\'}" ng-change="$ctrl.onChangeScene()">\n\t\t\t      <md-option ng-value="scene" ng-repeat="scene in $ctrl.scenes track by scene._id">{{::scene.name}}</md-option>\n\t\t\t    </md-select>\n\t\t\t  </div>\n\t    </v-pane-content>\n\t  </v-pane>\n\n\t  <v-pane ng-if="::($ctrl.item.hasOwnProperty(\'attrs\'))">\n\t    <v-pane-header>\n\t\t\t\tAttributes\n\t    </v-pane-header>\n\t    <v-pane-content>\n\t\t\t  <div layout="row" layout-padding>\n\t\t\t  \t<entity-controls ng-model="$ctrl.item"></entity-controls>\n\t\t\t  </div>\n\t    </v-pane-content>\n\t  </v-pane>\n\t</v-accordion>\n\n  <div class="md-toolbar-tools">\n    <md-button class="md-warn" aria-label="Go Back" ng-click="$ctrl.removeThis()">\n      {{ ::($ctrl.newItem ? \'Cancel\' : \'Delete\') }}\n    </md-button>\n    <span flex></span>\n    <md-button class="md-primary" aria-label="Save draft" ng-click="$ctrl.saveDraft()">\n      Save draft\n    </md-button>\n    <md-button class="md-raised md-primary" aria-label="Publish" ng-click="$ctrl.publish()">\n      {{ ::($ctrl.newItem ? \'Add\' : \'Publish\') }}\n    </md-button>\n  </div>\n\n</div>'},610:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e,n,i,a){"ngInject";var s=this;(0,o.default)(this,t),this.$filter=n,this.LocationResource=i.location,this.BuildingResource=i.building,this.SceneResource=i.scene,this.CategoryResource=a.category,this.FeatureResource=a.feature,this.CollectionResource=a.collection,this.item.scene&&e.$applyAsync(function(){s.initCurrentScene()}),this.item.feature&&e.$applyAsync(function(){s.initCurrentFeature()})}return t.$inject=["$scope","$filter","$tourApi","$mapApi"],(0,s.default)(t,[{key:"initCurrentCategory",value:function(){var t=this,e=void 0;this.loadCategories(function(n){e=t.feature.properties.category&&t.feature.properties.category.hasOwnProperty("_id")?t.feature.properties.category._id:t.feature.properties.category,t.category=t.$filter("filter")(n,{_id:e},!0)[0]})}},{key:"initCurrentFeature",value:function(){var t=this,e=void 0;this.loadFeatures(function(n){e=t.item.feature&&t.item.feature.hasOwnProperty("_id")?t.item.feature._id:t.item.feature,t.feature=t.$filter("filter")(n,{_id:e},!0)[0],t.initCurrentCategory()})}},{key:"initCurrentScene",value:function(){var t=this,e=void 0;this.loadScenes(function(n){e=t.item.scene.hasOwnProperty("_id")?t.item.scene._id:t.item.scene,t.scene=t.$filter("filter")(n,{_id:e},!0)[0],t.initCurrentBuilding()})}},{key:"initCurrentBuilding",value:function(){var t=this,e=void 0;this.loadBuildings(function(n){e=t.scene.parent.hasOwnProperty("_id")?t.scene.parent._id:t.scene.parent,t.building=t.$filter("filter")(n,{_id:e},!0)[0],t.initCurrentLocation()})}},{key:"initCurrentLocation",value:function(){var t=this,e=void 0;this.loadLocations(function(n){e=t.building.parent.hasOwnProperty("_id")?t.building.parent._id:t.building.parent,t.location=t.$filter("filter")(n,{_id:e},!0)[0]})}},{key:"loadLocations",value:function(t){var e=this;return this.LocationResource.query().$promise.then(function(n){e.locations=n,t&&t(n)})}},{key:"loadBuildings",value:function(t){var e=this;return this.BuildingResource.query(this.location?{filter:{parent:this.location._id}}:null).$promise.then(function(n){
e.buildings=n,t&&t(n)})}},{key:"loadScenes",value:function(t){var e=this;return this.SceneResource.query(this.building?{filter:{parent:this.building._id}}:null).$promise.then(function(n){e.scenes=n,t&&t(n)})}},{key:"loadCategories",value:function(t){var e=this;return this.CategoryResource.query().$promise.then(function(n){e.categories=n,t&&t(n)})}},{key:"loadFeatures",value:function(t){var e=this;return this.FeatureResource.query(this.category?{filter:{"properties.category":this.category._id}}:null).$promise.then(function(n){e.features=n,t&&t(n)})}},{key:"onChangeCategory",value:function(){this.feature=null}},{key:"onChangeFeature",value:function(){this.item.feature=this.feature}},{key:"onChangeScene",value:function(){this.item.scene=this.scene._id}},{key:"onChangeBuilding",value:function(){this.item.building=this.building._id,this.scene=null}},{key:"onChangeLocation",value:function(){this.item.location=this.location._id,this.building=null,this.scene=null}}]),t}();exports.default=r},611:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(310),l=n(r),c=e(302),u=n(c),d=e(304),m=n(d),f=e(612),p=n(f),h=o.default.module("drilldown",[s.default,l.default,u.default,m.default]).component("drilldownMenu",p.default).config(["$stateProvider",function(t){"ngInject";t.state("locations",{parent:"home",url:"/",component:"drilldownMenu",resolve:{Tour:"$tourApi",children:["Tour",function(t){return t.location.query({sort:"name"}).$promise}],nextLevel:function(){return"location"}}}).state("location",{parent:"locations",url:":location",component:"drilldownMenu",resolve:{currentLocation:["$stateParams","Tour",function(t,e){return e.location.query({filter:{code:t.location}}).$promise}],sceneData:["currentLocation","Tour",function(t,e){if(t[0]&&t[0].default)return e.scene.get({id:t[0].default}).$promise}],children:["$stateParams","$aframeScene","currentLocation","sceneData","Tour",function(t,e,n,i,o){return t.building||t.scene||!i||(e.scene=i),o.building.query({filter:{parent:n[0]._id},sort:"name"}).$promise}],nextLevel:["children",function(t){return"building"}]}}).state("building",{parent:"location",url:"/:building",component:"drilldownMenu",resolve:{currentBuilding:["$stateParams","Tour",function(t,e){return e.building.query({filter:{code:t.building}}).$promise}],sceneData:["currentBuilding","Tour",function(t,e){if(t[0]&&t[0].default)return e.scene.get({id:t[0].default}).$promise}],children:["$stateParams","$aframeScene","currentLocation","currentBuilding","sceneData","Tour",function(t,e,n,i,o,a){return!t.scene&&o&&(e.scene=o),a.scene.query({filter:{parent:i[0]._id},sort:"name"}).$promise}],nextLevel:function(){return"scene"}}}).state("scene",{parent:"building",url:"/:scene",resolve:{currentScene:["$stateParams","currentBuilding","Tour",function(t,e,n){return n.scene.query({filter:{code:t.scene,parent:e[0]._id}}).$promise}],sceneData:["currentScene","Tour",function(t,e){if(1===t.length&&t[0]._id)return e.scene.get({id:t[0]._id}).$promise}],item:["$aframeScene","sceneData",function(t,e){return e&&e.panorama&&(t.scene=e),e}]}})}]).name;exports.default=h},612:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(613),o=n(i),a=e(614),s=n(a);e(616);var r={template:o.default,controller:s.default,controllerAs:"item",bindings:{nextLevel:"@",children:"<"}};exports.default=r},613:function(t,exports){t.exports='<md-content\n\tclass="drilldown-menu"\n\tng-init="children = item.children">\n\t<div ng-if="!item.children.length" style="padding-right: 30px;" class="drilldown-content">\n\t\t<span class="md-title">No {{ ::item.nextLevel }}s found!<br/>\n\t\t<strong class="md-caption">&laquo; Back</strong></span>\n\t</div>\n</md-content>'},614:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){t.selected=t===this}function o(t){t.active=t.hidden=!1,t.children&&(0,m.forEach)(t.children,o)}function a(t){t.active=t===this,t.hidden=!(t===this),!t.active&&t.children&&(0,m.forEach)(t.children,o)}Object.defineProperty(exports,"__esModule",{value:!0});var s=e(615),r=n(s),l=e(323),c=n(l),u=e(324),d=n(u),m=e(299),f=function(){function t(e,n,i,o,a){"ngInject";(0,c.default)(this,t),this.$scope=e,this.$state=o,this.$element=n,this.$compile=i,this.$analytics=a}return t.$inject=["$scope","$element","$compile","$state","$analytics"],(0,d.default)(t,[{key:"$onInit",value:function(){var t=this;this.$scope.toggle=function(e,n){e.stopPropagation(),"scene"!==t.nextLevel?n.item.active?(0,m.forEach)(n.$parent.children,o):(0,m.forEach)(n.$parent.children,a,n.item):(0,m.forEach)(n.$parent.children,i,n.item),t.$analytics.eventTrack("click",{category:"drilldown",label:[n.$parent.code,n.item.code].join("_")}),t.$state.go(t.nextLevel,(0,r.default)({},t.nextLevel,n.item.code))};var e=this.$element.find("md-content")[0];this.children.forEach(function(n,i){var o=t.$scope.$new();o.item=n,t.$compile('<div\n\t\t\t\tclass="drilldown-item"\n\t\t\t\tng-class="{ \'is-active\': item.active, \'is-hidden\': item.hidden }"\n\t\t\t\tmd-ink-ripple="{{ item.active ? false : \'#003C71\' }}"\n\t\t\t\tng-click="toggle($event, this)"\n\t\t\t\tmd-autofocus="'+(0===i)+'">\n\t\t\t\t<div ng-if="!item.hidden" style="padding-right: 30px;" class="drilldown-content" ng-class="{\'md-caption\': item.active, \'md-title\': !item.active, \'selected\': item.selected }">\n\t\t\t\t\t<span>{{ ::item.name }}</span>\n\t\t\t\t\t<div class="open-indicator"></div>\n\t\t\t\t</div>\n\t\t\t\t<ui-view ng-if="item.active" />\n\t\t\t</div>')(o,function(t,n){e.append(t[0])})})}}]),t}();exports.default=f},616:function(t,exports){},618:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(619),l=n(r),c=e(620),u=n(c),d=e(621),m=n(d),f=e(622),p=n(f);e(623);var h=o.default.module("map",[s.default,l.default,u.default]).config(["$stateProvider",function(t){"ngInject";t.state("map",{parent:"home",template:m.default,controller:p.default,bindToController:!0,controllerAs:"$ctrl"})}]).name;exports.default=h},621:function(t,exports){t.exports='<campus-map\n\tmap-data="$ctrl.mapData"\n\ton-goto-bldg="$ctrl.onGotoBldg()"\n\tlayout\n\tflex="grow">\n\t<campus-map-controls ng-model="$ctrl.mapData" layout="column" flex="grow"></campus-map-controls>\n</campus-map>'},622:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=function(){function t(e){"ngInject";(0,o.default)(this,t),this._$state=e}return t.$inject=["$state"],(0,s.default)(t,[{key:"onGotoBldg",value:function(){var t=this;return function(e){t._$state.go("building",e)}}}]),t}();exports.default=r},623:function(t,exports){},625:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(310),l=n(r),c=e(626),u=n(c),d=o.default.module("search",[s.default,l.default]).component("searchMenu",u.default).config(["$stateProvider",function(t){"ngInject";t.state("search",{parent:"home",url:"/",component:"searchMenu"})}]).constant("SEARCH_FILTERS",{typeFilters:[{label:"Virtual Tour",value:"tour"},{label:"Campus Map",value:"map"}],modelFilters:{tour:[{label:"Buildings",value:"buildings"},{label:"Tour scenes",value:"scenes"}],map:[{label:"Map features",value:"features"},{label:"Feature collections",value:"collections"}]},fieldFilters:[{label:"Name",value:"name,label"},{label:"Description",value:"desc"},{label:"Acronym",value:"code"}]}).name;exports.default=d},626:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(627),o=n(i),a=e(628),s=n(a);e(635);var r={template:o.default,controller:s.default,bindings:{query:"@",filters:"<"}};exports.default=r},627:function(t,exports){t.exports='<div class="search-bar" layout="column" layout-fill>\n\n\t<div layout="column" layout-align="center center" layout-margin layout-padding flex>\n<!-- \t  <md-input-container md-no-float class="md-block md-icon-left">\n\t\t\t<ng-md-icon icon="search" size="24"></ng-md-icon>\n\t\t\t<input ng-model="$ctrl.query" aria-label="Search the Virtual Tour" id="search_q">\n\t\t</md-input-container> -->\n\t\t<label for="search_q">I\'m looking for things with</label>\n\t\t<div layout="row" layout-align="space-between center">\n\t\t\t<ng-md-icon class="search-icon" icon="search" size="24" ng-class="{ \'active\': searchActive }"></ng-md-icon>\n\t\t\t<form ng-submit="$event.preventDefault()" class="search-form" flex="shrink">\n\t\t\t\t<md-autocomplete\n\t\t\t\t\t\tmd-search-text="$ctrl.searchText"\n\t\t\t\t\t\tmd-search-text-change="$ctrl.searchTextChange($ctrl.searchText)"\n\t\t\t\t\t\tmd-items="item in $ctrl.querySearch($ctrl.searchText)"\n\t\t\t\t\t\tmd-item-text="item"\n\t\t\t\t\t\tmd-selected-item="$ctrl.selectedItem"\n\t\t\t\t\t\tmd-selected-item-change="$ctrl.selectedItemChange(item)"\n\t\t\t\t\t\tmd-min-length="2"\n\t\t\t\t\t\tmd-no-cache\n\t\t\t\t\t\tplaceholder="charles st"\n\t\t\t\t\t\tmd-menu-class="search-results"\n\t\t\t\t\t\tmd-autofocus\n\t\t\t\t\t\tng-focus="searchActive = true"\n\t\t\t\t\t\tng-blur="searchActive = false"\n\t\t\t\t\t\tflex>\n\t\t\t\t\t\t<md-item-template>\n\t\t\t\t\t\t\t<span md-highlight-text="$ctrl.searchText" md-highlight-flags="gi">{{ item }}</span>\n\t\t\t\t\t\t</md-item-template> \n\t\t\t\t\t<!-- <md-item-template>\n\t\t\t\t\t\t<span class="md-headline" md-highlight-text="$ctrl.searchText" md-highlight-flags="gi">{{ item.name }}</span><br/>\n\t\t\t\t\t\t<span class="md-caption">{{ item.parent.name }}</span><\n\t\t\t\t\t\t<span class="md-subhead" ng-bind-html="item.desc" md-highlight-text="$ctrl.searchText"></span>\n\t\t\t\t\t</md-item-template> -->\n\t\t\t\t</md-autocomplete>\n\t\t\t</form>\n\t\t</div>\n\t\t<div layout="row" layout-wrap class="search-filters">\n\t\t\t<div layout="row" layout-align="space-between center">\n\t\t\t\t<label flex="noshrink">within the</label>\n\t\t\t\t<md-input-container>\n\t\t\t\t\t<md-select ng-model="$ctrl.filters.in"\n\t\t\t\t\t\tid="search_filter"\n\t\t\t\t\t\taria-label="filter - search in"\n\t\t\t\t\t\tmultiple\n\t\t\t\t\t\tflex="shrink">\n\t\t\t\t\t\t\t<md-option ng-value="type.value" ng-repeat="type in ::$ctrl.typeFilters">{{type.label}}</md-option>\n\t\t\t\t\t</md-select>\n\t\t\t\t</md-input-container>\n\t\t\t</div>\n\t\t\t<div layout="row" layout-align="space-between center">\n\t\t\t\t<label flex="noshrink">for all</label>\n\t\t\t\t<md-input-container>\n\t\t\t\t\t<md-select ng-model="$ctrl.filters.for"\n\t\t\t\t\t\tid="search_filter"\n\t\t\t\t\t\taria-label="filter - search for"\n\t\t\t\t\t\tmultiple\n\t\t\t\t\t\tflex="shrink">\n\t\t\t\t\t\t<md-optgroup label="Virtual Tour" ng-show="!$ctrl.filters.in.length || $ctrl.filters.in.includes(\'tour\')">\n\t\t\t\t\t\t\t<md-option ng-value="type.value" ng-repeat="type in ::$ctrl.modelFilters.tour">{{type.label}}</md-option>\n\t\t\t\t\t\t</md-optgroup>\n\t\t\t\t\t\t<md-optgroup label="Campus Map" ng-show="!$ctrl.filters.in.length || $ctrl.filters.in.includes(\'map\')">\n\t\t\t\t\t\t\t<md-option ng-value="type.value" ng-repeat="type in ::$ctrl.modelFilters.map">{{type.label}}</md-option>\n\t\t\t\t\t\t</md-optgroup>\n\t\t\t\t\t</md-select>\n\t\t\t\t</md-input-container>\n\t\t\t</div>\n\t\t\t<div layout="row" layout-align="space-between center">\n\t\t\t\t<label flex="noshrink">by their</label>\n\t\t\t\t<md-input-container>\n\t\t\t\t\t\t<md-select ng-model="$ctrl.filters.by"\n\t\t\t\t\t\t\t\t\t\t\t aria-label="filter - search by"\n\t\t\t\t\t\t\t\t\t\t\t multiple\n\t\t\t\t\t\t\t\t\t\t\t flex="shrink">\n\t\t\t\t\t\t\t<!-- <md-optgroup label="Virtual tour" ng-repeat="type in ::$ctrl.typeFilters">\n\t\t\t\t\t\t\t\t<md-option ng-value="::type.value">{{::type.label}}</md-option>\n\t\t\t\t\t\t\t</md-optgroup> -->\n\t\t\t\t\t\t\t<!-- <md-optgroup label="Campus map"> -->\n\t\t\t\t\t\t\t\t<md-option ng-value="::field.value" ng-repeat="field in ::$ctrl.fieldFilters">{{::field.label}}</md-option>\n\t\t\t\t\t\t\t<!-- </md-optgroup> -->\n\t\t\t\t\t\t</md-select>\n\t\t\t\t</md-input-container>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<md-content layout="column" layout-align="start center" layout-margin layout-padding class="search-results" flex="60">\n\t\n\t\t<span class="md-headline" ng-show="!$ctrl.searchResults">No results found<span ng-show="$ctrl.searchText"> matching "<em>{{ $ctrl.searchText }}</em>"</span>!</span>\n\n\t\t<md-list>\n\t\t\t<md-subheader class="md-no-sticky" ng-repeat-start="(type, results) in $ctrl.searchResults"><ng-md-icon class="search-icon" icon="chevron_right" size="14" style="width: 16px; height: 16px;"></ng-md-icon> {{ ::type }}</md-subheader>\n      <md-list-item class="md-3-line" ng-repeat-start="item in results" ng-click="$ctrl.goToResult(type, item)">\n        <!-- <img ng-src="{{item.face}}?{{$index}}" class="md-avatar" alt="{{item.who}}" /> -->\n        <div class="md-list-item-text" layout="column">\n          <h3><strong>{{ ::item.name }}</strong><span ng-if="::item.parent.parent.name">, {{::item.parent.name}}</span></h3>\n          <h4>{{ ::(item.parent.parent.name || item.parent.name) }}</h4>\n          <span ng-bind-html="::item.desc | limitTo:150" ng-class="{ \'truncated-text\': (item.desc.length >= 100) }"></span>\n        </div>\n      </md-list-item>\n\t\t\t<md-divider ng-repeat-end></md-divider>\n\t\t\t<span ng-repeat-end></span>\n\t\t</md-list>\n\n\t</md-content>\n\t\n</div>'},628:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(588),o=n(i),a=e(629),s=n(a),r=e(418),l=n(r),c=e(598),u=n(c),d=e(323),m=n(d),f=e(324),p=n(f),h=(e(299),function(){function t(e,n,i,o){"ngInject";(0,m.default)(this,t),this.$log=e,this.$http=n,this.$state=i;var a=o.typeFilters,s=o.modelFilters,r=o.fieldFilters;(0,u.default)(this,{typeFilters:a,modelFilters:s,fieldFilters:r})}return t.$inject=["$log","$http","$state","SEARCH_FILTERS"],(0,p.default)(t,[{key:"$onInit",value:function(){this.searchResults=[],this.filters={in:[],for:[],by:[]}}},{key:"querySearch",value:function(t){var e=this;if(!t)return[];var n={q:t};return this.filters.for.length&&(n.filter=this.filters.for),this.filters.by.length&&(n.fields=this.filters.by),this.$http.get("/api/v1/search",{params:n}).then(function(t){var n=[];return(0,l.default)(t.data.results).forEach(function(e){return n.push.apply(n,(0,s.default)(t.data.results[e]))}),e.searchResults=!!(0,l.default)(t.data.results).length&&t.data.results,console.log(t.data),t.data.overview})}},{key:"searchTextChange",value:function(t){this.$log.info("Text changed to "+t)}},{key:"selectedItemChange",value:function(t){this.$log.info("Item changed to "+(0,o.default)(t))}},{key:"goToResult",value:function(t,e){var n={};switch(t){case"location":n.location=e.code;break;case"building":n.location=e.parent.code,n.building=e.code;break;case"scene":n.location=e.parent.parent.code,n.building=e.parent.code,n.scene=e.code}console.log(n),this.$state.go(t,n)}}]),t}());exports.default=h},635:function(t,exports){},637:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(299),o=n(i),a=e(301),s=n(a),r=e(306),l=n(r),c=e(310),u=n(c),d=e(638),m=n(d),f=e(640),p=n(f),h=e(642),g=n(h),v=e(647),b=n(v),y=e(648),_=n(y),k=o.default.module("settings",[s.default,l.default,u.default,m.default,p.default]).component("userSettings",g.default).factory("SettingsFactory",b.default).service("ConnectionDetails",_.default).config(["$stateProvider",function(t){"ngInject";t.state("settings",{parent:"home",url:"/",component:"userSettings"})}]).name;exports.default=k},642:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(643),o=n(i),a=e(644),s=n(a);e(645);var r={restrict:"E",bindings:{},template:o.default,controller:s.default};exports.default=r},643:function(t,exports){t.exports='<md-content layout="column" layout-align="start center" class="user-dashboard" layout-fill>\n\n\t<md-card id="user_dashboard" layout="column" layout-align="center center" flex="noshrink" ng-if="!$ctrl.isLoggedIn()">\n\t  <md-card-header layout-align="space-around center" class="signin-msg">\n\t    <md-card-content layout="column">\n\t      <p class="md-headline"><strong>Sign in or register</strong> to save your user preferences permanently!</p>\n\t      <p class="md-subtitle">Preferences will still be saved without a user but will be limited to your browser session.</p>\n\t      <md-button ng-click="$ctrl.promptLogin()" class="md-raised md-primary" md-autofocus="!$ctrl.isLoggedIn()">Sign in</md-button>\n\t      <md-button href="/keystone/signin" target="_self" class="md-primary">Register</md-button>\n\t    </md-card-content>\n\t  </md-card-header>\n\t</md-card>\n\n\t<md-card id="user_dashboard" flex="none" ng-if="$ctrl.isLoggedIn()">\n\t\t<img src="assets/images/north_bg.jpg" alt="" class="md-card-image" />\n\t  <md-card-header layout-align="space-around center">\n\t    <md-card-avatar><img ng-src="{{ $ctrl.user.avatar.secure_url }}" class="md-user-avatar"/></md-card-avatar>\n\t    <md-card-header-text><span class="md-headline">{{ [$ctrl.user.name.first, $ctrl.user.name.last].join(\' \') }}</span><span class="md-subhead">{{ $ctrl.user.bannerId }}</span></md-card-header-text>\n\t  </md-card-header>\n\t  <md-card-actions layout="row" layout-align="start center">\n      <md-button aria-label="go to admin" class="md-primary md-raised" ng-if="$ctrl.user.isAdmin || $ctrl.user.isEditor" href=\'/keystone\', target=\'_self\'>\n        Admin\n      </md-button>\n\t    <md-button ng-click="$ctrl.logout()" class="md-raised">Sign out</md-button>\n\t    <md-card-icon-actions>\n\t      <md-button aria-label="edit profile" class="md-icon-button md-primary" md-autofocus="$ctrl.isLoggedIn()">\n\t        <ng-md-icon icon="edit"></ng-md-icon>\n\t      </md-button>\n\t    </md-card-icon-actions>\n\t  </md-card-actions>\n\t</md-card>\n\n\t<md-card flex="nogrow" id="user_settings">\n  \t<v-accordion class="vAccordion--default" multiple flex control="accordion">\n\t\t  <!-- add expanded attribute to open the section -->\n\t\t  <v-pane>\n\t\t    <v-pane-header>\n  \t\t\t\tApp settings\n\t\t    </v-pane-header>\n\t\t    <v-pane-content>\n\t\t\t\t\t<md-list>\n\t\t\t\t\t  <md-list-item ng-repeat="(key, setting) in $ctrl.settings">\n\t\t\t\t\t    <ng-md-icon icon="{{::setting.icon}}" ng-attr-style="fill: {{ setting.val? \'#003c71\':\'#cccccc\'}}" flex="nogrow"></ng-md-icon>\n\t\t\t\t\t    <span flex>{{ ::setting.label }}</span>\n\t\t\t\t\t    <md-switch class="md-primary" ng-model="$ctrl.settings[key].val" ng-change="$ctrl.updateSettings()" aria-label="{{ ::setting.label }}"></md-switch>\n\t\t\t\t\t  </md-list-item>\n\t\t\t\t\t</md-list>\n\t\t    </v-pane-content>\n\t\t  </v-pane>\n\n\t\t  <v-pane>\n\t\t    <v-pane-header>\n\t\t      Data usage\n\t\t    </v-pane-header>\n\n\t\t    <v-pane-content>\n\t\t    \t<div layout="column" layout-padding>\n\t\t\t\t\t\t<span class="md-subhead">\n\t\t\t\t\t\t\t<strong>Current:</strong>\n\t\t\t\t\t\t\t<span class="md-caption">\n\t\t\t\t\t\t\t\t<strong>{{ $ctrl.usageLevel[0] }} image quality</strong> with <strong>{{ $ctrl.usageLevel[1] }} load time</strong> and <strong>{{ $ctrl.usageLevel[2] }} data consumption</strong> \n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<md-divider></md-divider>\n\t\t\t\t\t\t<label ng-repeat="(key, setting) in $ctrl.usage" flex>\n\t\t\t\t\t    <md-checkbox ng-if="key === \'auto\'" class="md-primary" ng-model="setting.val" ng-change="$ctrl.detectConnection()" aria-label="Auto-detect optimum settings" ng-disabled="$ctrl.connection.loading">\n\t\t            <div layout="row" layout-align="space-between stretch">\n\t\t            \t<span flex="noshrink">{{ $ctrl.connection.loading ? \'Detecting network...\' : \'Auto-detect optimum settings\'; }}</span>\n\t\t            \t<span flex="grow"></span>\n\t\t            \t<md-progress-circular md-mode="indeterminate" md-diameter="16" ng-show="$ctrl.connection.loading"></md-progress-circular>\n\t\t            </div>\n\t\t          </md-checkbox>\n\t\t\t\t\t\t\t{{ ::setting.label }}<br/>\n\t\t\t\t    \t<md-slider-container flex ng-if="key !== \'auto\'" ng-disabled="$ctrl.usage.auto.val">\n\t\t\t\t\t      <h5>{{ ::setting.labels[0] }}</h5>\n\t\t\t\t\t      <md-slider ng-model="setting.val" step="{{::setting.step}}" min="{{::setting.min}}" max="{{::setting.max}}" aria-label="{{setting.label}}" class="md-primary" md-discrete ng-change="$ctrl.updateUsage()"></md-slider>\n\t\t\t\t\t      <h5>{{ ::setting.labels[1] }}</h5>\n\t\t\t\t\t    </md-slider-container>\n\t\t\t\t\t\t</label>\n\n\t\t\t    </div>\n\n\t\t    </v-pane-content>\n\t\t  </v-pane>\n\n\t\t</v-accordion>\n\t</md-card>\n</md-content>'},644:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(323),o=n(i),a=e(324),s=n(a),r=e(299),l=function(){function t(e,n,i,a,s,r,l,c){"ngInject";(0,o.default)(this,t),this.$scope=e,this.$animate=n,this.$mdUtil=i,this.$popupWindow=a,this.UserAuth=s,this.UserSession=r,this.ConnectionDetails=l,this.AUTH_EVENTS=c}return t.$inject=["$scope","$animate","$mdUtil","$popupWindow","UserAuth","UserSession","ConnectionDetails","AUTH_EVENTS"],(0,s.default)(t,[{key:"$onInit",value:function(){var t=this;this.isLoggedIn=this.UserAuth.isAuthenticated,this.user=this.UserSession.user,this.settings=this.UserSession.settings,this.usage=this.UserSession.usage,this.connection=!1;var e=this.$scope.$watch("accordion",function(n){n&&(t.$scope.$applyAsync(function(){t.isLoggedIn()&&n.expandAll()}),e())});this.$scope.$on(this.AUTH_EVENTS.loginSuccess,this.loadUserAfterLogin.bind(this)),this.getUsageLevel()}},{key:"expandAll",value:function(){this.$scope.accordion.expandAll()}},{key:"collapseAll",value:function(){this.$scope.accordion.collapseAll()}},{key:"promptLogin",value:function(){return this.$popupWindow.login()}},{key:"logout",value:function(){var t=this,e=this.$mdUtil.createBackdrop(this.$scope,"md-dialog-backdrop md-opaque");e[0].tabIndex=-1,this.$animate.enter(e,(0,r.element)(document.body),null),this.UserAuth.logout().then(function(){t.$animate.leave(e),t.collapseAll()})}},{key:"loadUserAfterLogin",value:function(t,e){this.user=this.UserSession.user,this.settings=this.UserSession.settings,this.usage=this.UserSession.usage,this.updateUsage(),this.updateSettings(),this.expandAll()}},{key:"updateSettings",value:function(){this.UserSession.settings=this.settings}},{key:"updateUsage",value:function(t){this.UserSession.usage=t||this.usage,this.getUsageLevel()}},{key:"getUsageLevel",value:function(){var t=this;this.ConnectionDetails.calculateUsageLevel(this.UserSession.usage).then(function(e){t.usageLevel=t.ConnectionDetails.getLabelsFromTally(e)})}},{key:"detectConnection",value:function(){var t=this;this.usage.auto.val&&(this.connection={loading:!0},this.ConnectionDetails.detect().then(function(e){t.connection=e,t.usage=t.ConnectionDetails.optimize(e),t.updateUsage()}))}}]),t}();exports.default=l},645:function(t,exports){},647:function(t,exports){"use strict";function e(t){"ngInject";return t.getNamespacedStore("appSettings")}e.$inject=["store"],Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},648:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(418),o=n(i),a=e(323),s=n(a),r=e(324),l=n(r),c=e(299),u=50,d=8,m=2,f=function(){function t(e,n,i,o){"ngInject";(0,s.default)(this,t),this.$rootScope=e,this.$http=n,this.$q=i,this.profiles=o.profiles}return t.$inject=["$rootScope","$http","$q","USER_DEFAULTS"],(0,l.default)(t,[{key:"detect",value:function(){var t=this;return this.$http.get("/user/connection").then(function(e){return t.connection=e,e})}},{key:"optimize",value:function(t){var e=t.data,n=e.network,i=e.useragent,o=n.speeds.download,a=i.device.type;return o>=u&&!a?this.profiles.desktopFast:o>=d&&o<u&&!a?this.profiles.desktopSlow:o<d&&!a?this.profiles.balanced:o>=d&&"mobile"===a?this.profiles.mobileWifi:o>=m&&"mobile"===a?this.profiles.mobile3g:o<m?this.profiles.conserve:this.profiles.balanced}},{key:"calculateUsageLevel",value:function(t){var e=this,n=[0,0,0],i=this.$q.defer(),a=function(t){n.forEach(function(e,i){n[i]+=t[i]})};return this.$rootScope.$applyAsync(function(){(0,o.default)(t).forEach(function(n){"auto"!==n&&(0,o.default)(t[n].levels).forEach(function(o){var s=e.$rootScope.$eval("("+t[n].val+" "+o+")");s&&a(t[n].levels[o]),(0,c.isNumber)(s)&&i.reject("Usage calculation error")})}),i.resolve(n)}),i.promise}},{key:"getLabelsFromTally",value:function(t){return t.map(function(t){return t<=5?"very low":t>5&&t<=10?"low":t>10&&t<=15?"moderate":t>15&&t<=20?"high":t>20?"very high":void 0})}}]),t}();exports.default=f},649:function(t,exports,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var i=e(650),o=n(i),a=e(651),s=n(a);e(652);var r={template:o.default,controller:s.default,controllerAs:"mc",restrict:"E"};exports.default=r},650:function(t,exports){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" style="display:none;">\n  <filter id="blur">\n    <fegaussianblur stddeviation="10"></fegaussianblur>\n  </filter>\n</svg>\n\n<div flex="" layout="column" layout-fill="">\n  <title-bar title="Virtual Tour" mobile="mc.mobile" flex="nogrow">\n    <title-bar-button ng-repeat="(o, option) in mc.titlebar.options" on-click="mc.titlebar.clickHandlers[o]()" label="{{ ::option.label }}" active="option.active" icon="option.icon" tooltip="option.tooltip" class="{{ ::option.class }}">\n    </title-bar-button>\n  </title-bar>\n\n  <div layout="column"\n  \t\t layout-gt-sm="row"\n  \t\t layout-align="end stretch"\n  \t\t layout-align-gt-sm="end start"\n  \t\t flex\n  \t\t class="scene-container"\n  \t\t ng-class="{ \'toolbar-open\' : mc.toolbar.isOpen&amp;&amp;!mc.mobile.landscape, \'toolbar-condensed\': mc.toolbar.isCondensed }">\n    <section id="scene-view"\n\t\t\t\t     flex="grow"\n\t\t\t\t     layout="column"\n\t\t\t\t     layout-fill=""\n\t\t\t\t     ng-class="{ \'blur-active\' : mc.sidebar.hasBlur() }"\n\t\t\t\t     class="scene-view">\n      <aframe-scene mobile="mc.mobile">\n\t      <scene-editor ng-if="!(mc.mobile.device &amp;&amp; mc.mobile.landscape)"></scene-editor>\n      </aframe-scene>\n    </section>\n\n    <button-bar layout="row"\n    \t\t\t\t\t\tlayout-gt-sm="column"\n    \t\t\t\t\t\tflex="nogrow"\n    \t\t\t\t\t\titems="mc.toolbar.views"\n    \t\t\t\t\t\topen="mc.toolbar.isOpen"\n    \t\t\t\t\t\tcondensed="mc.toolbar.isCondensed"\n    \t\t\t\t\t\tmobile="mc.mobile">\n    </button-bar>\n  </div>\n</div>\n\n<div ng-class="{ \'toolbar-open\' : mc.toolbar.isOpen&amp;&amp;!landscapeMobile, \'toolbar-condensed\': mc.toolbar.isCondensed }" layout="row" flex="">\n  <md-sidenav ng-class="{ \'blur-active\' : mc.sidebar.hasBlur(), \'is-mobile\': mc.mobile.screen, \'is-landscape\': mc.mobile.landscape }" md-component-id="right" md-disable-backdrop="" md-whiteframe="4" flex="" class="md-sidenav-right main-menu">\n    <ui-view flex="" layout="column" layout-fill="" resizable="" r-directions="[&quot;left&quot;]" ng-style="{ maxWidth: (\'map\' | isState) ? \'none\' : \'600px\' }"></ui-view>\n  </md-sidenav>\n</div>'},651:function(t,exports,e){"use strict";function n(t,e,n,a,s,r,l,c,u){"ngInject";var d=this,m=500,f=1e3,p=["search","map"];this.mobile={},t.$watch(function(){return{screen:!s("gt-sm"),landscape:s("landscape"),device:i.utils.device.isMobile()}},function(t){d.mobile=t},!0);var h=function(t){switch(t){case"ok":e.go("settings"),a("right").open()}},g=function(){var t=l.usage.auto;t&&t.val?r.toast("primary",{message:"Data usage settings auto-configured to your device!",action:"Change settings"}).then(function(t){h(t)}):r.toast("warn",{message:"Automatic data usage is currently disabled, but can be enabled in Settings.",action:"Show me how"}).then(function(t){h(t)})},v=function(){r.welcome().then(function(t){return"tour"!=t&&g()}).catch(function(){return g()})},b=t.$watch(function(){return l.settings},function(t){if(!(0,o.isUndefined)(t)){console.log("main controller applying settings");var i=l.settings,s=i.showWelcome,r=i.toolbarOpen,h=i.toolbarCondensed;s.val?n(v,m):n(g,f),d.titlebar={options:u,clickHandlers:{config:function(){a("config").toggle()},right:function(){d.toolbar.toggle(),d.titlebar.options.right.active=d.toolbar.isOpen},condense:function(){d.toolbar.condense(),d.titlebar.options.condense.active=d.toolbar.isCondensed}}},d.toolbar={views:c,isOpen:r.val,isCondensed:h.val,toggle:function(){this.isOpen=!this.isOpen,this.isOpen&&a("right").close()},condense:function(){return!this.isOpen&&this.toggle(),this.isCondensed=!this.isCondensed,this.isCondensed}},d.sidebar={hasState:function(t){return e.includes(t)},hasBlur:function(){return p.some(this.hasState)}},b()}})}n.$inject=["$scope","$state","$timeout","$mdSidenav","$mdMedia","$popupWindow","UserSession","BUTTONBAR_VIEWS","TITLEBAR_OPTS"],Object.defineProperty(exports,"__esModule",{value:!0});var i=e(434),o=e(299);exports.default=n},652:function(t,exports){}});
//# sourceMappingURL=app.bundle.js.map